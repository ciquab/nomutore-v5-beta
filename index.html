<!DOCTYPE html>
<html lang="ja" class="light">
<head>
    <style>
    /* header, main, 下部ナビ, FAB をJS制御が完了するまで完全に隠す */
    header.hidden, 
    main.hidden, 
    #bottom-nav.hidden, 
    #btn-fab-fixed.hidden {
        display: none !important;
    }

    /* アプリの準備ができるまで、LP以外の表示を禁止する */
    body:not(.app-ready) #bottom-nav,
    body:not(.app-ready) #btn-fab-fixed,
    body:not(.app-ready) header,
    body:not(.app-ready) main {
        display: none !important;
    }
    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com https://accounts.google.com https://apis.google.com;
        worker-src 'self' blob:;
        style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com https://fonts.googleapis.com;
        font-src 'self' data: https://fonts.gstatic.com https://unpkg.com;
        img-src 'self' data: blob: https://api.qrserver.com;
        connect-src 'self' data: blob: https://www.googleapis.com https://accounts.google.com https://apis.google.com https://asia-northeast1-nomutore-backup.cloudfunctions.net https://api.qrserver.com https://fonts.googleapis.com https://fonts.gstatic.com https://unpkg.com;
        object-src 'none';
        form-action 'self';
    ">
    <title>NOMUTORE</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" id="meta-theme-color" content="#f8fafc">
    <script>
      // JS モジュールの読み込みを待たずにテーマを即時適用し、ナビバーの点滅を防ぐ
      (function(){
        var t = localStorage.getItem('nomutore_theme') || 'system';
        var d = t === 'dark' || (t === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches);
        if (d) {
          document.documentElement.classList.replace('light', 'dark');
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0f172a');
        }
      })();
    </script>
    <link rel="apple-touch-icon" href="icon-192_2.png">
    <link rel="icon" href="icon-192_2.png" type="image/png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet" crossorigin="anonymous">

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.css" integrity="sha384-bovbcpDBo0pTIhd7ws6ebPh1PG31ubAHcX2pv8Tcu5EtFHNl5FBciYFtS/e2SN66" crossorigin="anonymous">

    <link rel="stylesheet" href="https://unpkg.com/@phosphor-icons/web@2.1.1/src/bold/style.css" integrity="sha384-nblAP2mo2pVPyMQZDw9Xy9Cwgs9lowushAYep4w5+Q9kF4Ibf3n0B/gCMVdR+Vqy" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/@phosphor-icons/web@2.1.1/src/fill/style.css" integrity="sha384-pPVoXE8ft+zxKtxIDDI7SfTK6y95NHm4qa+hKEg/hs8VkjW5IP+9/dGOPCbDpUPl" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/@phosphor-icons/web@2.1.1/src/duotone/style.css" integrity="sha384-UVFvhZP7fWAENUPOoq61rJg5ef6QZW0k5vpAn71041/QS4STvUcJQCGNhStZLGx9" crossorigin="anonymous">
    
    <link rel="stylesheet" href="tailwind-output.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1/dist/chart.umd.min.js" integrity="sha384-jb8JQMbMoBUzgWatfe6COACi2ljcDdZQ2OxczGA3bGNeWe+6DChMTBJemed7ZnvJ" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/dexie@3.2.4/dist/dexie.js" integrity="sha384-dPjGJ3rBpGktXk5Oc6fSuIzpWQb1Uk+yIt23iySD3broHItJTZOIKJVzRDCvW9kx" crossorigin="anonymous"></script>

    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js" async defer></script>

<script>
  window.addEventListener('DOMContentLoaded', () => {
    // body全体を操作不可にして、ヘッダー含む全要素を保護する
    document.body.style.pointerEvents = 'none';
    
    // 安全策（万が一JSがロードされなかった場合のタイムアウト復帰）
    setTimeout(() => {
        document.body.style.pointerEvents = 'auto';
    }, 3000);
  });
</script>

</head>
<body class="preload antialiased selection:bg-indigo-500 selection:text-white bg-base-50 dark:bg-base-900 text-base-900 dark:text-gray-100">
    <script>
        // JSモジュールのロードを待たずに、LocalStorageを爆速でチェック
        (function() {
            var lpSeen = localStorage.getItem('nomutore_lp_seen_v5');
            var onboardingComplete = localStorage.getItem('nomutore_onboarding_complete');

            if (lpSeen && onboardingComplete) {
                // 継続ユーザーなら、描画が始まる前にLPとコンセプトページを物理的に隠す
                var s = document.createElement('style');
                s.textContent = '#landing-page, #concept-page { display: none !important; }';
                document.head.appendChild(s);
            }
        })();
    </script>

    <div id="landing-page" class="fixed inset-0 z-[600] flex flex-col items-center justify-center bg-[#0f172a] overflow-hidden">
    <div class="bubble-container absolute inset-0 z-0" aria-hidden="true"></div>

    <div class="absolute inset-0 bg-gradient-to-b from-indigo-900/20 via-transparent to-amber-900/20 pointer-events-none z-10" aria-hidden="true"></div>

    <div class="relative z-20 flex flex-col items-center text-center">
        <div class="relative mb-12">
            <div class="absolute -inset-10 bg-amber-500/20 blur-[60px] rounded-full animate-pulse-slow"></div>
            <img src="logo-header.png" class="relative w-48 h-48 object-contain opacity-0"> 
        </div>

        <h1 class="text-3xl font-black text-white tracking-[0.2em] mb-4 italic">NOMUTORE</h1>
        <p class="text-xs font-bold text-slate-400 tracking-widest leading-loose">
            CONDITIONING FOR BEER GEEKS
        </p>

        <button data-action="onboarding:close" class="mt-16 px-12 py-4 bg-transparent border-2 border-white text-white rounded-full font-black tracking-[0.3em] hover:bg-white hover:text-slate-900 transition-all duration-500">
            ENTER
        </button>
    </div>
</div>

    <a href="#tab-home" class="skip-nav">メインコンテンツへスキップ</a>

    <header class="fixed top-0 w-full z-40 bg-white/70 dark:bg-base-900/70 backdrop-blur-xl border-b border-white/40 dark:border-white/5 transition-colors hidden">
        <div class="container mx-auto max-w-md h-14 flex items-center justify-between px-4">
            
            <div class="flex items-center gap-3 flex-shrink-0">
                <img src="logo-header.png" 
                     alt="Logo" 
                     class="w-10 h-10 object-contain filter drop-shadow-md dark:drop-shadow-[0_0_8px_rgba(255,255,255,0.3)] transition-all">
                
                <div class="flex flex-col items-start justify-center h-10">
                    <h1 class="text-xl font-['Outfit'] font-black tracking-tighter leading-none text-indigo-900 dark:text-white">
                        NOMUTORE
                    </h1>
                    <span class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 tracking-widest uppercase leading-none mt-0.5">
                        Beer & Burn
                    </span>
                </div>
            </div>

            <div class="flex items-center gap-1">
                <button data-action="ui:applyTheme" aria-label="テーマ切替" class="w-11 h-11 flex items-center justify-center rounded-full transition flex-shrink-0">
                    <i id="theme-icon" class="ph-fill ph-sun text-lg text-orange-500" aria-hidden="true"></i>
                </button>
                <button data-action="ui:switchTab" data-args='["settings"]' aria-label="設定" class="w-11 h-11 flex items-center justify-center rounded-full text-gray-500 dark:text-gray-400 hover:text-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition flex-shrink-0">
                    <i class="ph-bold ph-gear text-lg" aria-hidden="true"></i>
                </button>
            </div>
            </div>
    </header>

    <main class="container mx-auto max-w-md pt-20 px-4 pb-32 hidden">
        
        <div id="tab-home" class="tab-content active space-y-6">

            <section class="relative text-center pt-0 pb-0">
                <div class="glass-panel rounded-2xl px-8 pt-16 pb-4 mb-6 relative overflow-hidden text-center main-display-glow transition-all duration-300">
                <button data-action="ui:openShareModal" aria-label="シェア" class="absolute left-3 top-1/2 -translate-y-1/2 z-10 w-11 h-11 flex items-center justify-center rounded-full bg-white/30 dark:bg-black/20 backdrop-blur-sm border border-white/20 text-indigo-500 hover:bg-white/60 dark:hover:bg-black/40 transition">
                    <i class="ph-bold ph-share-network text-lg" aria-hidden="true"></i>
                </button>
                <button id="btn-help" data-action="modal:openHelp" aria-label="ヘルプ" class="absolute right-3 top-1/2 -translate-y-1/2 z-10 w-11 h-11 flex items-center justify-center rounded-full bg-white/30 dark:bg-black/20 backdrop-blur-sm border border-white/20 text-gray-500 dark:text-gray-400 hover:text-indigo-500 hover:bg-white/60 dark:hover:bg-black/40 transition">
                    <i class="ph-bold ph-question text-lg" aria-hidden="true"></i>
                </button>
                <div class="absolute top-4 left-0 right-0 flex justify-center z-20">
        <div class="relative group">
            <div class="relative flex items-center gap-2 bg-white/40 dark:bg-black/20 backdrop-blur-md px-3 py-1 rounded-full border border-white/20 transition hover:bg-white/60 dark:hover:bg-black/40">
                <i class="ph-fill ph-beer-bottle text-brand dark:text-brand-light text-xs" aria-hidden="true"></i>
                <span id="beer-select-display" class="text-xs font-bold text-base-900 dark:text-white min-w-[60px] text-center truncate">
                    Loading...
                </span>
                <i class="ph-bold ph-caret-down text-base-900/50 dark:text-white/50 text-[11px]" aria-hidden="true"></i>

                <select id="header-mode-select" aria-label="ビアスタイル切替" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                    <option value="mode1">Lager</option>
                    <option value="mode2">Ale</option>
                </select>
            </div>
        </div>
    </div>
    <div id="tank-wrapper" class="relative inline-block mt-2">
    <div class="orb-container relative"> <div id="orb-liquid-back" class="liquid-layer liquid-back" style="top: 100%;"></div>
        <div id="orb-liquid-front" class="liquid-layer liquid-front" style="top: 100%;"></div>
        
        <div class="relative z-10 flex flex-col items-center justify-center">
            <div id="tank-mode-label" class="text-[11px] uppercase font-bold tracking-widest text-base-800/40 dark:text-white/40 mb-1">Balance</div>
            <div aria-live="polite" aria-atomic="true" class="flex items-baseline justify-center">
                <span id="tank-cans" class="text-4xl font-bold text-base-800 dark:text-white drop-shadow-sm">0.0</span>
                <span class="text-sm font-bold text-base-800/60 dark:text-white/60 ml-1">cans</span>
            </div>
            <div id="tank-minutes" class="text-xs font-bold text-base-800/50 dark:text-white/50 mt-1">0 min</div>
            <div id="tank-empty-icon" class="hidden absolute text-4xl opacity-50"><i class="ph-fill ph-sparkle" aria-hidden="true"></i></div>
        </div>
    </div>
    </div>

    <div id="tank-message" class="mt-6 min-h-[24px] text-sm font-bold text-gray-500"></div>
</div>
            </section>

            <section class="grid grid-cols-2 gap-3 items-stretch">
                <div id="liver-rank-card" class="glass-panel p-4 rounded-2xl relative overflow-hidden group transition hover:border-indigo-300 dark:hover:border-indigo-700 cursor-pointer" data-action="modal:openHelp" data-args='["game-mechanics"]'>
                    </div>
                <div id="check-status" class="glass-panel p-4 rounded-2xl relative overflow-hidden group transition hover:border-emerald-300 dark:hover:border-emerald-700 cursor-pointer" data-action="modal:openCheck">
                    </div>
            </section>

            <section id="alcohol-meter-card" class="glass-panel p-4 rounded-2xl">
            </section>

            <section class="glass-panel p-5 rounded-2xl">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="section-title text-sm font-bold flex items-center gap-2">
                        <i class="ph-fill ph-fire section-icon text-orange-500" aria-hidden="true"></i> Streak
                    </h3>
                    <div class="flex items-center gap-2">
                        <span id="streak-badge" class="text-[11px] font-bold px-2 py-0.5 bg-orange-100 text-orange-600 rounded-full">x1.0</span>
                        <span id="streak-count" class="text-xl font-black text-base-800 dark:text-white">0</span>
                    </div>
                </div>
                <div class="mb-2 flex items-center justify-between px-1">
                    <span class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Weekly</span>
                    <span id="weekly-range-label" class="text-[11px] font-mono text-gray-500 dark:text-gray-400"></span>
                </div>
                <div id="weekly-calendar" class="grid grid-cols-7 gap-2"></div>
            </section>

        </div>

        <div id="tab-record" class="tab-content pb-24 hidden space-y-6">
    <div class="flex items-center justify-start gap-2 px-2 mb-1">
        <h2 class="text-2xl font-black text-base-900 dark:text-white tracking-tight">Record</h2>
        <button data-action="modal:openHelp" data-args='["help-record"]' aria-label="記録のヘルプ" class="w-11 h-11 rounded-full flex items-center justify-center text-gray-300 hover:text-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition">
            <i class="ph-bold ph-question text-lg" aria-hidden="true"></i>
        </button>
    </div>

    <section class="px-1">
        <h3 class="section-title text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 ml-1">よく飲むビール</h3>
        <div class="flex gap-2 overflow-x-auto pb-2 scrollbar-hide" id="record-shortcuts-beer">
            </div>
    </section>

    <section class="px-1">
        <h3 class="section-title text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 ml-1">いつもの運動</h3>
        <div class="flex gap-2 overflow-x-auto pb-2 scrollbar-hide" id="record-shortcuts-exercise">
            </div>
    </section>

    <hr class="border-gray-100 dark:border-gray-800 mx-2">

    <section class="px-1">
        <h3 class="section-title text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 ml-1">手入力</h3>
        <div class="grid grid-cols-2 gap-3">
            
            <button data-action="modal:openBeer" class="group relative overflow-hidden p-4 rounded-2xl bg-amber-50 dark:bg-amber-900/20 border border-amber-100 dark:border-amber-800 flex flex-col items-center justify-center gap-2 active:scale-95 transition h-28">
                <div class="w-10 h-10 rounded-full bg-white dark:bg-amber-900/40 flex items-center justify-center text-amber-500 shadow-sm group-hover:scale-110 transition">
                    <i class="ph-duotone ph-beer-bottle text-2xl" aria-hidden="true"></i>
                </div>
                <div class="text-center">
                    <span class="block text-xs font-bold text-base-900 dark:text-white">ビールを記録</span>
                    <span class="block text-[11px] text-gray-500">銘柄・詳細入力</span>
                </div>
            </button>

            <button data-action="modal:openExercise" class="group relative overflow-hidden p-4 rounded-2xl bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800 flex flex-col items-center justify-center gap-2 active:scale-95 transition h-28">
                <div class="w-10 h-10 rounded-full bg-white dark:bg-indigo-900/40 flex items-center justify-center text-indigo-500 shadow-sm group-hover:scale-110 transition">
                    <i class="ph-duotone ph-person-simple-run text-2xl" aria-hidden="true"></i>
                </div>
                <div class="text-center">
                    <span class="block text-xs font-bold text-base-900 dark:text-white">運動を記録</span>
                    <span class="block text-[11px] text-gray-500">家事・通勤・ジム</span>
                </div>
            </button>

        </div>
    </section>

    <section class="px-1">
        <h3 class="section-title text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 ml-1">コンディション & ツール</h3>
        <div class="grid grid-cols-2 gap-3">
            
            <button data-action="modal:openCheck" class="p-4 rounded-2xl bg-white dark:bg-base-800 border border-gray-100 dark:border-gray-700 flex items-center gap-3 active:scale-95 transition hover:border-emerald-200 shadow-sm">
                <div class="w-10 h-10 rounded-full bg-emerald-50 dark:bg-emerald-900/20 flex items-center justify-center text-emerald-500 shrink-0">
                    <i class="ph-duotone ph-heartbeat text-xl" aria-hidden="true"></i>
                </div>
                <div class="text-left">
                    <span class="block text-xs font-bold text-base-900 dark:text-white">デイリー<br>チェック</span>
                    <span class="block text-[11px] text-gray-500 dark:text-gray-400">休肝日・体重</span>
                </div>
            </button>

            <button data-action="modal:openTimer" class="p-4 rounded-2xl bg-white dark:bg-base-800 border border-gray-100 dark:border-gray-700 flex items-center gap-3 active:scale-95 transition hover:border-gray-300 shadow-sm">
                <div class="w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-base-900 dark:text-white shrink-0">
                    <i class="ph-duotone ph-timer text-xl" aria-hidden="true"></i>
                </div>
                <div class="text-left">
                    <span class="block text-xs font-bold text-base-900 dark:text-white">ストップ<br>ウォッチ</span>
                    <span class="block text-[11px] text-gray-500 dark:text-gray-400">没入モード</span>
                </div>
            </button>

        </div>
    </section>
</div>
        <div id="tab-stats" class="tab-content hidden space-y-4">
            <div class="flex flex-wrap items-center justify-between gap-y-2 px-2 mb-1">
                <div class="flex items-center gap-2 shrink-0">
                    <h2 class="text-2xl font-black text-base-900 dark:text-white tracking-tight">Stats</h2>
                </div>
                <div role="tablist" aria-label="Stats表示切替" class="flex min-w-0 bg-gray-100 dark:bg-gray-800 rounded-lg p-1">
                    <button id="btn-stats-activity" role="tab" aria-selected="true" aria-controls="view-stats-activity" data-action="ui:switchStatsView" data-args='["activity"]' class="subtab-pill is-active">Activity</button>
                    <button id="btn-stats-beer" role="tab" aria-selected="false" aria-controls="view-stats-beer" data-action="ui:switchStatsView" data-args='["beer"]' class="subtab-pill">Beer</button>
                </div>
            </div>

            <div id="view-stats-activity" role="tabpanel" aria-labelledby="btn-stats-activity" class="pb-24 px-1 space-y-4">
                <section class="glass-panel p-5 rounded-2xl">
                    <h3 class="section-title text-sm font-bold flex items-center gap-2 mb-4">
                        <i class="ph-fill ph-calendar-dots section-icon text-indigo-500" aria-hidden="true"></i> 活動カレンダー
                    </h3>
                    <div class="flex justify-between items-center mb-2 px-1">
                        <button id="heatmap-prev" aria-label="前の期間" class="min-w-[44px] min-h-[44px] flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-gray-500 dark:text-gray-400">◀</button>
                        <span id="heatmap-period-label" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400">Loading...</span>
                        <button id="heatmap-next" aria-label="次の期間" class="min-w-[44px] min-h-[44px] flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-gray-500 dark:text-gray-400">▶</button>
                    </div>
                    <div id="heatmap-grid" class="grid grid-cols-7 gap-1.5"></div>
                </section>

                <section class="glass-panel p-5 rounded-2xl">
                    <h3 class="section-title text-sm font-bold flex items-center gap-2 mb-4">
                        <i class="ph-fill ph-scales section-icon text-emerald-500" aria-hidden="true"></i> カロリーバランス推移
                    </h3>
                    <div class="h-56 w-full">
                        <canvas id="balanceChart"></canvas>
                    </div>
                    <div id="chart-filters" role="group" aria-label="チャート期間フィルター" class="flex justify-center gap-2 mt-3">
                        <button data-range="1w" aria-pressed="false" class="min-w-[44px] min-h-[44px]">1W</button>
                        <button data-range="1m" aria-pressed="true" class="min-w-[44px] min-h-[44px]">1M</button>
                        <button data-range="3m" aria-pressed="false" class="min-w-[44px] min-h-[44px]">3M</button>
                    </div>
                </section>

                <div id="health-insights-section" class="space-y-4"></div>
            </div>

            <div id="view-stats-beer" role="tabpanel" aria-labelledby="btn-stats-beer" class="hidden pb-24 px-1">
                <div class="flex items-center justify-center h-40">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"></div>
                </div>
            </div>
        </div>

        <div id="tab-cellar" class="tab-content space-y-4 hidden">
     <div class="flex flex-wrap items-center justify-between gap-y-2 px-2 mb-1">
        <div class="flex items-center gap-2 shrink-0">
            <h2 class="text-2xl font-black text-base-900 dark:text-white tracking-tight">Cellar</h2>
            <button data-action="modal:openHelp" data-args='["help-cellar"]' aria-label="セラーのヘルプ" class="w-11 h-11 rounded-full flex items-center justify-center text-gray-300 hover:text-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition">
                <i class="ph-bold ph-question text-lg" aria-hidden="true"></i>
            </button>
        </div>
                <div role="tablist" aria-label="セラー表示切替" class="flex min-w-0 bg-gray-100 dark:bg-gray-800 rounded-lg p-1">
                    <button id="btn-cellar-logs" role="tab" aria-selected="true" aria-controls="view-cellar-logs" data-action="ui:switchCellarView" data-args='["logs"]' class="subtab-pill is-active">Logs</button>
                    <button id="btn-cellar-collection" role="tab" aria-selected="false" aria-controls="view-cellar-collection" data-action="ui:switchCellarView" data-args='["collection"]' class="subtab-pill">Collections</button>
                    <button id="btn-cellar-archives" role="tab" aria-selected="false" aria-controls="view-cellar-archives" data-action="ui:switchCellarView" data-args='["archives"]' class="subtab-pill">Archives</button>
                </div>
             </div>

             <div id="view-cellar-logs" role="tabpanel" aria-labelledby="btn-cellar-logs" class="space-y-3 pb-24">
                 <section class="px-2 mb-2">
                     <h3 class="section-title text-sm font-bold text-base-900 dark:text-white">記録一覧</h3>
                     <p class="section-helper mt-0.5">時系列でログを確認・編集できます</p>
                 </section>

                 <section class="px-2 mb-2 space-y-2">
                    <div class="flex items-center justify-between gap-2">
                        <span id="history-base-label" class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wide">全件</span>
                        <div class="flex gap-3"> <button data-action="log:toggleEditMode" class="text-xs text-brand dark:text-brand-light font-bold hover:bg-gray-100 dark:hover:bg-gray-800 px-2 py-1 rounded transition">
                                編集
                            </button>
                            <button id="btn-select-all" data-action="log:toggleSelectAll" class="hidden text-xs text-indigo-500 font-bold">すべて選択</button>
                        </div>
                    </div>

                    <div class="flex gap-1.5 overflow-x-auto pb-1">
                        <button id="log-filter-type-all" class="subtab-pill is-active" data-log-type="all" type="button">全て</button>
                        <button id="log-filter-type-beer" class="subtab-pill" data-log-type="beer" type="button">ビール</button>
                        <button id="log-filter-type-exercise" class="subtab-pill" data-log-type="exercise" type="button">運動</button>
                        <select id="log-filter-range" class="ml-auto bg-white dark:bg-base-900 border border-gray-200 dark:border-gray-700 rounded-lg text-[11px] font-bold py-1.5 px-2">
                            <option value="all">全期間</option>
                            <option value="7d">7日</option>
                            <option value="30d">30日</option>
                            <option value="month">今月</option>
                        </select>
                    </div>

                    <div class="relative">
                        <input id="log-filter-term" type="text" placeholder="ログを検索（銘柄・運動名・メモ）" class="w-full bg-white dark:bg-base-900 border border-gray-200 dark:border-gray-700 rounded-xl text-xs font-bold py-2.5 pl-9 pr-3 focus:ring-2 focus:ring-indigo-500 transition">
                        <i class="ph-bold ph-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400" aria-hidden="true"></i>
                    </div>
                    <p class="section-helper">※ Collectionsは銘柄集計、Logsは記録履歴の検索です</p>
                </section>
                 
                 <div id="edit-toolbar" class="hidden sticky top-16 z-30 bg-white/90 dark:bg-base-900/90 backdrop-blur p-2 rounded-xl shadow-lg border border-indigo-100 dark:border-indigo-900 mb-2 flex justify-between items-center">
                     <span aria-live="polite" aria-atomic="true" class="text-xs font-bold ml-2"><span id="bulk-selected-count">0</span> 件選択</span>
                     <button data-action="log:deleteSelected" aria-label="選択した記録を削除" class="bg-red-50 text-red-500 px-3 py-1.5 rounded-lg text-xs font-bold">削除</button>
                 </div>

                 <ul id="log-list" class="space-y-3 px-1"></ul>

                 <button id="btn-load-more" class="w-full py-3 text-sm text-gray-500 font-bold bg-base-50 dark:bg-base-900 rounded-xl mt-4 hidden transition active:scale-95">
                     もっと見る
                 </button>
 
                 <div id="bulk-action-area" class="hidden fixed bottom-24 left-0 right-0 z-40 flex justify-center pointer-events-none">
                     <button id="btn-delete-selected" data-action="log:deleteSelected" class="pointer-events-auto shadow-lg bg-red-500 text-white px-6 py-3 rounded-full font-bold shadow-red-500/30 transition-all transform translate-y-20 opacity-0 flex items-center gap-2 disabled:opacity-50">
                         <i class="ph-bold ph-trash" aria-hidden="true"></i>
                         選択を削除
                     </button>
                 </div>

                 <div id="edit-spacer" class="h-16 hidden"></div>
             </div>

             <div id="view-cellar-collection" role="tabpanel" aria-labelledby="btn-cellar-collection" class="hidden pb-24 px-1"></div>

             <div id="view-cellar-archives" role="tabpanel" aria-labelledby="btn-cellar-archives" class="hidden pb-24 px-1"></div>
        </div>

        <div id="tab-settings" class="tab-content pb-40 hidden relative z-0">
    <div class="flex items-center justify-start gap-2 px-2 mb-4">
        <h2 class="text-2xl font-black text-base-900 dark:text-white tracking-tight">Settings</h2>
        <button data-action="modal:openHelp" data-args='["help-settings"]' aria-label="設定のヘルプ" class="w-11 h-11 rounded-full flex items-center justify-center text-gray-300 hover:text-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition">
            <i class="ph-bold ph-question text-lg" aria-hidden="true"></i>
        </button>
    </div>

            <div class="glass-panel p-5 rounded-2xl mb-4">
                <h3 class="section-title text-sm font-bold mb-4 flex items-center gap-2">
                    <i class="ph-fill ph-user-circle text-indigo-500" aria-hidden="true"></i>
                    プロフィール
                </h3>

                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="weight-input" class="text-xs font-medium text-gray-500 mb-1 block">体重 (kg)</label>
                        <input type="number" id="weight-input" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition" placeholder="60">
                    </div>
                    <div>
                        <label for="height-input" class="text-xs font-medium text-gray-500 mb-1 block">身長 (cm)</label>
                        <input type="number" id="height-input" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition" placeholder="170">
                    </div>
                    <div>
                        <div class="flex items-center mb-1 h-5">
                            <label for="age-input" class="text-xs font-medium text-gray-500 block">年齢</label>
                        </div>
                        <input type="number" id="age-input" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition" placeholder="30">
                    </div>
                    <div>
                        <div class="flex items-center gap-1 mb-1 h-5">
                            <label for="gender-input" class="text-xs font-medium text-gray-500 block">計算基準</label>
                            <span class="relative group" tabindex="0" role="button" aria-label="基礎代謝量とアルコール上限の計算に使用します">
                                <i class="ph-duotone ph-info text-gray-400 text-sm cursor-help" aria-hidden="true"></i>
                                <span class="absolute bottom-full right-0 mb-1.5 px-2.5 py-1.5 bg-gray-800 text-white text-[10px] leading-tight rounded-lg w-48 opacity-0 pointer-events-none group-hover:opacity-100 group-focus:opacity-100 transition-opacity z-50" role="tooltip">基礎代謝量とアルコール上限の計算に使用します</span>
                            </span>
                        </div>
                        <select id="gender-input" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition">
                            <option value="male">男性の基準</option>
                            <option value="female">女性の基準</option>
                            <option value="other">その他</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="glass-panel p-5 rounded-2xl mb-4">
                <h3 class="section-title text-sm font-bold mb-4 flex items-center gap-2">
                    <i class="ph-fill ph-gear text-indigo-500" aria-hidden="true"></i>
                    環境設定
                </h3>

                <div class="mb-4">
                    <label for="setting-period-mode" class="text-xs font-medium text-gray-500 mb-1 block">集計期間</label>
                    <select id="setting-period-mode" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold mb-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition">
                        <option value="weekly">週次（月曜リセット）</option>
                        <option value="monthly">月次（1日リセット）</option>
                        <option value="custom">カスタム（任意の期間）</option> <option value="permanent">永久（リセットなし）</option>
                    </select>
                </div>

                <div id="custom-period-settings" class="hidden mb-4 p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-xl border border-indigo-100 dark:border-indigo-800/50 space-y-3">
                    <div>
                        <label for="custom-period-label" class="text-xs font-medium text-gray-500 mb-1 block">プロジェクト名</label>
                        <input type="text" id="custom-period-label" placeholder="例: 夏休みダイエット"
                               class="w-full p-2 bg-white dark:bg-base-800 rounded-lg border border-indigo-100 dark:border-indigo-800 text-sm font-bold placeholder-gray-400">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label for="custom-start-date" class="text-xs font-medium text-gray-500 mb-1 block">開始日</label>
                            <input type="date" id="custom-start-date"
                                   class="w-full p-2 bg-white dark:bg-base-800 rounded-lg border border-indigo-100 dark:border-indigo-800 text-sm font-mono font-bold text-gray-700 dark:text-gray-200">
                        </div>
                        <div>
                            <label for="custom-end-date" class="text-xs font-medium text-gray-500 mb-1 block">終了日</label>
                            <input type="date" id="custom-end-date"
                                   class="w-full p-2 bg-white dark:bg-base-800 rounded-lg border border-indigo-100 dark:border-indigo-800 text-sm font-mono font-bold text-gray-700 dark:text-gray-200">
                        </div>
                    </div>
                    <p class="text-[11px] text-indigo-800 dark:text-indigo-300 opacity-70 leading-tight">
                        ※指定した終了日まで記録が続きます。<br>終了後はアーカイブされ、通常モードに戻るか選択できます。
                    </p>
                </div>

                <div class="mb-4">
                    <label for="theme-input" class="text-xs font-medium text-gray-500 mb-1 block">テーマ</label>
                    <select id="theme-input" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition">
                        <option value="system">システムに合わせる</option>
                        <option value="light">ライトモード</option>
                        <option value="dark">ダークモード</option>
                    </select>
                </div>

                <div class="mb-4">
                    <label for="setting-mode-1" class="text-xs font-medium text-gray-500 mb-1 block">メインビール</label>
                    <select id="setting-mode-1" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition"></select>
                </div>

                <div class="mb-4">
                    <label for="setting-mode-2" class="text-xs font-medium text-gray-500 mb-1 block">サブビール</label>
                    <select id="setting-mode-2" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition"></select>
                </div>

                <div class="mb-4">
                    <label for="setting-base-exercise" class="text-xs font-medium text-gray-500 mb-1 block">基準運動</label>
                    <select id="setting-base-exercise" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition"></select>
                </div>

                <div class="mb-2">
                    <label for="setting-default-record-exercise" class="text-xs font-medium text-gray-500 mb-1 block">デフォルト運動</label>
                    <select id="setting-default-record-exercise" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition"></select>
                </div>
            </div>

            <!-- 通知設定 -->
            <div class="glass-panel p-5 rounded-2xl mb-4">
                <h3 class="section-title text-sm font-bold mb-4 flex items-center gap-2">
                    <i class="ph-fill ph-bell-ringing text-amber-500" aria-hidden="true"></i>
                    通知
                </h3>

                <div id="notif-permission-banner" class="hidden mb-4 p-3 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-100 dark:border-amber-800/50">
                    <p class="text-[11px] text-amber-700 dark:text-amber-300 font-medium mb-2">通知を受け取るにはブラウザの許可が必要です。</p>
                    <button id="btn-notif-permission" class="w-full py-2 bg-amber-500 text-white rounded-lg font-bold text-xs hover:bg-amber-600 transition active:scale-95">
                        通知を許可する
                    </button>
                </div>

                <!-- デイリーリマインダー -->
                <div class="flex items-center justify-between mb-3">
                    <div class="flex-1 mr-3">
                        <p class="text-xs font-bold text-base-900 dark:text-white">デイリーリマインダー</p>
                        <p class="text-[11px] text-gray-500 dark:text-gray-400">未記録・未チェック時に通知</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer shrink-0">
                        <input type="checkbox" id="notif-daily-enabled" class="sr-only peer">
                        <div class="w-9 h-5 bg-gray-200 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-amber-500"></div>
                    </label>
                </div>
                <div id="notif-daily-time-row" class="hidden mb-4 pl-4 border-l-2 border-amber-200 dark:border-amber-800">
                    <label for="notif-daily-time" class="text-xs font-medium text-gray-500 mb-1 block">通知時刻</label>
                    <input type="time" id="notif-daily-time" value="21:00" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition">
                </div>

                <!-- 期間リセット前日通知 -->
                <div class="flex items-center justify-between mb-3">
                    <div class="flex-1 mr-3">
                        <p class="text-xs font-bold text-base-900 dark:text-white">リセット前日サマリー</p>
                        <p class="text-[11px] text-gray-500 dark:text-gray-400">期間リセット前日に借金と完済目安を通知</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer shrink-0">
                        <input type="checkbox" id="notif-period-eve-enabled" class="sr-only peer">
                        <div class="w-9 h-5 bg-gray-200 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-amber-500"></div>
                    </label>
                </div>
                <div id="notif-period-eve-time-row" class="hidden mb-2 pl-4 border-l-2 border-amber-200 dark:border-amber-800">
                    <label for="notif-period-eve-time" class="text-xs font-medium text-gray-500 mb-1 block">通知時刻</label>
                    <input type="time" id="notif-period-eve-time" value="20:00" class="w-full bg-base-50 dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-xl p-3 font-bold text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/40 focus:border-indigo-500 dark:focus:border-indigo-500 transition">
                </div>
            </div>

            <!-- Daily Checks (Updated Phase 1.5) -->
            <div class="glass-panel p-5 rounded-2xl mb-4">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="section-title text-sm font-bold flex items-center gap-2">
                        <i class="ph-fill ph-check-square-offset section-icon text-emerald-500" aria-hidden="true"></i>
                        デイリーチェック
                    </h3>
                </div>

                <!-- ★変更: ライブラリとカスタムの2つのボタンを配置 -->
                <div class="flex gap-2 mb-4">
                    <button data-action="modal:openCheckLibrary" class="flex-1 py-3 bg-indigo-100 text-brand rounded-xl font-bold text-xs flex items-center justify-center gap-2 hover:bg-indigo-200 transition">
                        <i class="ph-bold ph-list-plus" aria-hidden="true"></i> ライブラリを開く
                    </button>
                    <button data-action="check:addNewItem" class="flex-1 py-3 bg-white border border-gray-200 text-gray-600 rounded-xl font-bold text-xs flex items-center justify-center gap-2 hover:bg-gray-50 transition dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-700">
                        <i class="ph-bold ph-pencil-simple" aria-hidden="true"></i> カスタム追加
                    </button>
                </div>

                <div id="check-editor-list">
                    <!-- JS Injected -->
                </div>
            </div>

<div class="glass-panel p-5 rounded-2xl mb-4">
                <h3 class="section-title text-sm font-bold mb-4 flex items-center gap-2">
                    <i class="ph-fill ph-database text-indigo-500" aria-hidden="true"></i>
                    データ
                </h3>

                <!-- Googleドライブ連携 -->
                <div class="p-4 rounded-xl mb-4 bg-indigo-50/50 dark:bg-indigo-900/10 border border-indigo-100 dark:border-indigo-900/30">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-xs font-bold text-brand dark:text-brand-light flex items-center gap-2">
                            <i class="ph-fill ph-google-logo" aria-hidden="true"></i>
                            Googleドライブ連携
                        </h3>
                        <span class="text-[11px] font-bold bg-indigo-100 text-brand px-2 py-0.5 rounded-full dark:bg-indigo-900 dark:text-indigo-300">おすすめ</span>
                    </div>

                    <p class="text-[11px] text-gray-500 dark:text-gray-400 mb-3 font-medium">
                        データをGoogleドライブに安全に保存します。<br>
                        機種変更やデータ紛失に備えて、定期的に保存しましょう。
                    </p>

                    <div class="grid grid-cols-2 gap-3 mb-2">
                        <button id="btn-cloud-backup" data-action="data:backupToCloud" class="py-3 rounded-xl bg-brand text-white font-bold text-xs shadow-lg shadow-brand/20 hover:bg-brand-dark transition active:scale-95 flex flex-col items-center justify-center gap-1">
                            <i class="ph-bold ph-cloud-arrow-up text-xl" aria-hidden="true"></i>
                            <span>Backup</span>
                        </button>

                        <button id="btn-cloud-restore" data-action="data:restoreFromCloud" class="py-3 rounded-xl bg-white dark:bg-gray-800 text-brand dark:text-brand-light border border-indigo-100 dark:border-indigo-900 font-bold text-xs hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition active:scale-95 flex flex-col items-center justify-center gap-1">
                            <i class="ph-bold ph-cloud-arrow-down text-xl" aria-hidden="true"></i>
                            <span>Restore</span>
                        </button>
                    </div>
                    <div id="cloud-status" class="text-[11px] text-center text-gray-500 dark:text-gray-400 font-mono h-4 mt-1"></div>
                </div>

                <button data-action="data:exportCSV" data-args='["logs"]' class="w-full mb-3 py-3 rounded-xl bg-gray-100 dark:bg-gray-800 font-bold text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                    ログをエクスポート (CSV)
                </button>

                <button data-action="data:exportJSON" class="w-full mb-3 py-3 rounded-xl bg-gray-100 dark:bg-gray-800 font-bold text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                    バックアップを保存 (JSON)
                </button>

                <div class="relative">
                    <input type="file" id="import-file" class="hidden">
                    <button data-action="data:triggerImportFile" class="w-full py-3 rounded-xl bg-gray-100 dark:bg-gray-800 font-bold text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                        バックアップを読込 (JSON)
                    </button>
                </div>
            </div>

            <div class="glass-panel p-5 rounded-2xl mb-4">
                <h3 class="section-title text-sm font-bold mb-4 flex items-center gap-2">
                    <i class="ph-fill ph-info text-indigo-500" aria-hidden="true"></i>
                    このアプリについて
                </h3>
                <button data-action="modal:openHelp" class="w-full flex items-center justify-between p-4 bg-gray-100 dark:bg-gray-800 rounded-xl group transition hover:bg-gray-200 dark:hover:bg-gray-700 mb-3">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-full bg-white dark:bg-gray-700 flex items-center justify-center shadow-sm">
                            <i class="ph-fill ph-book-open text-indigo-500" aria-hidden="true"></i>
                        </div>
                        <div class="text-left">
                            <span class="block text-[11px] font-semibold text-gray-500 dark:text-gray-400">使い方</span>
                            <span class="block text-sm font-black text-base-900 dark:text-white">ユーザーガイド</span>
                        </div>
                    </div>
                    <i class="ph-bold ph-caret-right text-gray-500 dark:text-gray-400 group-hover:text-indigo-500 transition" aria-hidden="true"></i>
                </button>

                <!-- ★追加: Feedbackボタン (About内に統合) -->
                <a href="https://forms.gle/NUiN5R2rfxPvEixj8" target="_blank" rel="noopener noreferrer" class="w-full flex items-center justify-between p-4 bg-gray-100 dark:bg-gray-800 rounded-xl group transition hover:bg-gray-200 dark:hover:bg-gray-700">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-full bg-white dark:bg-gray-700 flex items-center justify-center shadow-sm">
                            <i class="ph-fill ph-chat-centered-text text-indigo-500" aria-hidden="true"></i>
                        </div>
                        <div class="text-left">
                            <span class="block text-[11px] font-semibold text-gray-500 dark:text-gray-400">フィードバック</span>
                            <span class="block text-sm font-black text-base-900 dark:text-white">報告する</span>
                        </div>
                    </div>
                    <i class="ph-bold ph-arrow-square-out text-gray-500 dark:text-gray-400 group-hover:text-indigo-500 transition" aria-hidden="true"></i>
                </a>
                <div class="mt-6 pt-4 border-t border-gray-100 dark:border-gray-800 text-center">
                    <p class="text-[10px] uppercase tracking-wider text-gray-300 dark:text-gray-600 mb-2">
                        Credits
                    </p>
                    <p class="text-[11px] text-gray-400 dark:text-gray-500">
                        Icons by 
                        <a href="https://phosphoricons.com" 
                           target="_blank" 
                           rel="noopener noreferrer"
                           class="hover:text-indigo-500 transition">
                            Phosphor Icons
                        </a> (MIT License)
                    </p>
                </div>
                
                <div class="mt-4 text-center space-y-2">
                    <div class="flex items-center justify-center gap-3 text-[11px] font-bold">
                        <a href="privacy.html" target="_blank" rel="noopener noreferrer" class="text-gray-500 dark:text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400 transition">プライバシーポリシー</a>
                        <span class="text-gray-300 dark:text-gray-600">|</span>
                        <a href="terms.html" target="_blank" rel="noopener noreferrer" class="text-gray-500 dark:text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400 transition">利用規約</a>
                    </div>
                    <p class="text-[11px] font-semibold text-gray-300 dark:text-gray-600">NOMUTORE Beta</p>
                </div>
            </div>
            <div class="glass-panel p-5 rounded-2xl mb-24 border border-red-100 dark:border-red-900/30">
                <h3 class="section-title text-sm font-bold mb-4 text-red-600 flex items-center gap-2">
                    <i class="ph-fill ph-warning section-icon" aria-hidden="true"></i>
                    危険ゾーン
                </h3>
                <p class="text-xs text-gray-500 mb-4">
                    すべての記録と設定を完全に削除し、初期状態に戻します。
                </p>
                <button id="btn-reset-all" class="w-full py-3 rounded-xl bg-red-50 text-red-600 font-bold text-xs hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/40 transition">
                    全データを削除
                </button>
            </div>
        </div>

    </main>

<nav id="bottom-nav" aria-label="メインナビゲーション" class="hidden fixed bottom-6 left-1/2 transform -translate-x-1/2 w-[90%] max-w-sm z-50">
    <div class="floating-nav rounded-full px-2 py-2 flex justify-between items-center transition-all duration-300">
        
        <button id="nav-tab-home" data-action="ui:switchTab" data-args='["home"]' class="nav-item nav-pill-active">
            <i class="ph-fill ph-house" aria-hidden="true"></i>
            <span class="label">Home</span>
        </button>

        <button id="nav-tab-record" data-action="ui:switchTab" data-args='["record"]' class="nav-item p-3 rounded-full hover:bg-base-100 dark:hover:bg-base-800 text-gray-500 dark:text-gray-400">
            <i class="ph-bold ph-plus-circle" aria-hidden="true"></i>
            <span class="label">Record</span>
        </button>

        <button id="nav-tab-stats" data-action="ui:switchTab" data-args='["stats"]' class="nav-item p-3 rounded-full hover:bg-base-100 dark:hover:bg-base-800 text-gray-500 dark:text-gray-400">
            <i class="ph-bold ph-chart-bar" aria-hidden="true"></i>
            <span class="label">Stats</span>
        </button>

        <button id="nav-tab-cellar" data-action="ui:switchTab" data-args='["cellar"]' class="nav-item p-3 rounded-full hover:bg-base-100 dark:hover:bg-base-800 text-gray-500 dark:text-gray-400">
            <i class="ph-bold ph-books" aria-hidden="true"></i>
            <span class="label">Cellar</span>
        </button>

    </div>
</nav>

<!-- ========================================
   Save Changes ボタンコンテナ
   ======================================== -->
<div id="settings-save-container"
    class="hidden fixed bottom-24 left-0 right-0 px-6 transition-all duration-300 ease-out">
    <div class="max-w-md mx-auto relative z-10">
        <button id="btn-save-settings" 
            class="relative z-10 w-full py-4 rounded-2xl bg-brand text-white font-bold shadow-[0_10px_30px_rgba(79,70,229,0.4)] hover:bg-brand-dark transition transform active:scale-95">
            変更を保存
        </button>
    </div>
</div>

<!-- ========================================
   FAB ボタン
   ======================================== -->
<button id="btn-fab-fixed" aria-label="クイック記録"
    class="hidden fixed bottom-24 right-6 z-40 w-14 h-14 bg-brand text-white rounded-2xl shadow-xl shadow-brand/30 flex items-center justify-center hover:scale-105 active:scale-95 transition-all duration-300 ease-out">    <i class="ph-bold ph-plus text-2xl" aria-hidden="true"></i>
</button>

    <div id="message-box" aria-live="polite" aria-atomic="true" class="fixed top-6 left-1/2 transform -translate-x-1/2 translate-y-[-150%] opacity-0 transition-all duration-300"></div>
    
    <div id="global-error-overlay" class="fixed inset-0 bg-black/90 hidden flex flex-col items-center justify-center p-6 text-white">
        <h2 class="text-2xl font-bold mb-4 text-red-500">システムエラー</h2>
        <pre id="error-details" class="bg-gray-800 p-4 rounded text-xs w-full overflow-auto mb-4 max-h-[50vh]"></pre>
        <div class="flex gap-4">
            <button data-action="system:reload" class="bg-white text-black px-6 py-2 rounded font-bold">再読み込み</button>
            <button id="btn-copy-error" class="border border-white px-6 py-2 rounded font-bold">ログをコピー</button>
        </div>
    </div>

<!-- Check Library Modal (Phase 1.5 New) -->
    <div id="check-library-modal" role="dialog" aria-modal="true" aria-labelledby="check-library-title" class="fixed inset-0 hidden items-center justify-center bg-black/50 backdrop-blur-sm p-4">
        <div class="bg-white dark:bg-base-900 w-full max-w-md rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[85vh] transform transition-all scale-95 opacity-0 duration-200">
            <div class="p-4 border-b border-base-200 dark:border-base-800 flex justify-between items-center z-20">
                <div>
                    <h3 id="check-library-title" class="font-black text-lg">チェック項目ライブラリ</h3>
                    <p class="text-[11px] text-gray-500 dark:text-gray-400">毎日チェックする項目を選択</p>
                </div>
                <button data-action="modal:close" data-args='["check-library-modal"]' aria-label="閉じる" class="w-11 h-11 rounded-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center transition text-gray-500 dark:text-gray-400">
    <i class="ph-bold ph-x text-lg" aria-hidden="true"></i></button>
            </div>
            
            <!-- Presets Section -->
            <div class="p-4 bg-white dark:bg-base-900 border-b border-base-200 dark:border-base-800 z-20">
                <p class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-2">クイックプリセット</p>
                <div class="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
    <button data-action="check:applyPreset" data-args='["default"]' class="flex-shrink-0 px-3 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-xs font-bold whitespace-nowrap hover:bg-indigo-100 hover:text-brand transition flex items-center gap-2">
        <i class="ph-duotone ph-shield-check text-lg" aria-hidden="true"></i> 基本セット
    </button>
    <button data-action="check:applyPreset" data-args='["diet"]' class="flex-shrink-0 px-3 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-xs font-bold whitespace-nowrap hover:bg-orange-100 hover:text-orange-600 transition flex items-center gap-2">
        <i class="ph-duotone ph-trend-down text-lg" aria-hidden="true"></i> ガチダイエット
    </button>
    <button data-action="check:applyPreset" data-args='["muscle"]' class="flex-shrink-0 px-3 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-xs font-bold whitespace-nowrap hover:bg-red-100 hover:text-red-600 transition flex items-center gap-2">
        <i class="ph-duotone ph-barbell text-lg" aria-hidden="true"></i> 筋トレ
    </button>
    <button data-action="check:applyPreset" data-args='["liver"]' class="flex-shrink-0 px-3 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg text-xs font-bold whitespace-nowrap hover:bg-emerald-100 hover:text-emerald-600 transition flex items-center gap-2">
        <i class="ph-duotone ph-first-aid text-lg" aria-hidden="true"></i> 肝臓ケア
    </button>
</div>
            </div>

            <!-- Library Content -->
            <div id="library-content" class="p-4 overflow-y-auto flex-1">
                <!-- JSでライブラリ一覧生成 -->
            </div>

            <div class="p-4 border-t border-base-200 dark:border-base-800 bg-white dark:bg-base-900 z-20">
                <button data-action="check:applyLibraryChanges" class="w-full py-3 bg-brand text-white rounded-xl font-bold shadow-lg shadow-brand/30 hover:bg-brand-dark transition">
                    選択を保存
                </button>
            </div>
        </div>
    </div>

<div id="action-menu-modal" class="fixed inset-0 flex items-end sm:items-center justify-center hidden pointer-events-none" role="dialog" aria-modal="true" aria-labelledby="action-menu-date-label">
    
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity duration-300 opacity-0 pointer-events-auto" data-action="modal:close" data-args='["action-menu-modal"]'></div>
    
    <div class="relative w-full sm:max-w-md bg-white dark:bg-base-900 rounded-t-3xl sm:rounded-3xl p-6 pb-10 transform transition-all duration-300 translate-y-full sm:translate-y-10 scale-95 opacity-0 pointer-events-auto max-h-[90vh] flex flex-col shadow-2xl">
        
        <div class="absolute top-3 left-1/2 -translate-x-1/2 w-12 h-1.5 bg-gray-300 dark:bg-gray-600 rounded-full sm:hidden"></div>

        <div class="flex justify-between items-center mb-6 shrink-0 mt-4 sm:mt-0">
            <div>
                <span class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">クイックアクション</span>
                <h3 id="action-menu-date-label" class="text-xl font-black text-base-900 dark:text-white leading-none mt-0.5 font-['Outfit']">Today</h3>
            </div>
            <button data-action="modal:close" data-args='["action-menu-modal"]' aria-label="閉じる" class="w-11 h-11 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                <i class="ph-bold ph-x text-lg" aria-hidden="true"></i>
            </button>
        </div>
        
        <input type="hidden" id="action-menu-target-date">

        <div class="overflow-y-auto -mx-2 px-2 pb-4 space-y-4">
            <div class="grid grid-cols-1 gap-2" id="action-menu-beer-presets"></div>
            
            <div id="action-menu-repeat-area"></div>
        </div>
        
    </div>
</div>

    <!-- Beer Modal -->
    <div id="beer-modal" role="dialog" aria-modal="true" aria-labelledby="beer-modal-title" class="fixed inset-0 hidden items-center justify-center bg-black/50 backdrop-blur-sm p-4">
        <div class="bg-white dark:bg-base-900 w-full max-w-md rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] transform transition-all scale-95 opacity-0 duration-200">
        <div class="relative z-10 p-4 border-b border-base-100 dark:border-base-800 flex justify-between items-center bg-white/95 dark:bg-base-900/95 backdrop-blur-md">
                <h3 id="beer-modal-title" class="font-bold text-lg">ビールを追加</h3>
                <button data-action="modal:close" data-args='["beer-modal"]' aria-label="閉じる" class="w-11 h-11 rounded-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center transition text-gray-500 dark:text-gray-400">
    <i class="ph-bold ph-x text-lg" aria-hidden="true"></i></button>
            </div>
            <div class="flex p-2 gap-2 bg-base-50 dark:bg-base-900">
                <button id="tab-beer-preset" class="flex-1 py-2 text-xs font-bold rounded-xl bg-brand text-white shadow-sm transition">プリセット</button>
                <button id="tab-beer-custom" class="flex-1 py-2 text-xs font-bold rounded-xl text-gray-500 hover:bg-base-200 dark:hover:bg-base-800 transition">カスタム</button>
            </div>
            <div class="p-5 overflow-y-auto space-y-4 relative z-0">
                <input type="hidden" id="editing-log-id" value="">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="check-date" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase">日付</label>
                        <input type="date" id="beer-date" class="w-full bg-base-50 dark:bg-base-800 border-none rounded-xl text-sm font-bold p-3 mt-1">
                    </div>
                    <div>
                        <label for="beer-count" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase">本数</label>
                        <div class="flex items-center gap-2 mt-1">
                            <button id="btn-beer-minus" class="w-10 h-10 rounded-xl bg-base-100 dark:bg-base-800 font-bold">-</button>
                            <input type="number" id="beer-count" value="1" class="w-full text-center bg-transparent font-bold text-lg" readonly>
                            <button id="btn-beer-plus" class="w-10 h-10 rounded-xl bg-base-100 dark:bg-base-800 font-bold">+</button>
                        </div>
                    </div>
                </div>
                <div id="beer-input-preset" class="space-y-4">
                    <div>
                        <label for="beer-select" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase">ビアスタイル</label>
                        <select id="beer-select" class="w-full bg-base-50 dark:bg-base-800 border-none rounded-xl text-sm font-bold p-3 mt-1"></select>
                    </div>
                    <div>
                        <label for="beer-size" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase">サイズ</label>
                        <select id="beer-size" class="w-full bg-base-50 dark:bg-base-800 border-none rounded-xl text-sm font-bold p-3 mt-1"></select>
                    </div>
                    <div id="preset-abv-container">
        <label class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase flex items-center gap-1">
            ABV (%) <span class="lowercase font-normal opacity-60">(Override)</span>
        </label>
        <div class="relative mt-1">
            <input type="number" id="preset-abv" step="0.1" placeholder="5.0" 
                   class="w-full bg-base-50 dark:bg-base-800 border-none rounded-xl text-sm font-bold p-3">
            <span class="absolute right-4 top-3 text-gray-500 dark:text-gray-400 font-bold">%</span>
        </div>
    </div>
                </div>
                <div id="beer-input-custom" class="hidden space-y-4">
                    <div class="grid grid-cols-2 gap-3 mb-5">
        <label class="cursor-pointer">
            <input type="radio" name="customType" value="sweet" checked class="peer hidden">
            <div class="p-3 rounded-xl border-2 border-transparent bg-gray-100 dark:bg-gray-800 text-gray-500 peer-checked:bg-brand peer-checked:text-white peer-checked:shadow-md transition-all text-center">
                <div class="text-[11px] font-semibold uppercase tracking-widest opacity-70">ビール・醸造酒</div>
                <div class="text-sm font-bold mt-0.5">醸造 / カクテル</div>
                <div class="text-[11px] opacity-80 mt-1">糖質あり</div>
            </div>
        </label>

        <label class="cursor-pointer">
            <input type="radio" name="customType" value="dry" class="peer hidden">
            <div class="p-3 rounded-xl border-2 border-transparent bg-gray-100 dark:bg-gray-800 text-gray-500 peer-checked:bg-brand peer-checked:text-white peer-checked:shadow-md transition-all text-center">
                <div class="text-[11px] font-semibold uppercase tracking-widest opacity-70">蒸留酒・スピリッツ</div>
                <div class="text-sm font-bold mt-0.5">蒸留酒 / 焼酎</div>
                <div class="text-[11px] opacity-80 mt-1">糖質ゼロ</div>
            </div>
        </label>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                         <div>
                            <label for="custom-abv" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase">ABV (%)</label>
                            <input type="number" id="custom-abv" class="w-full bg-base-50 dark:bg-base-800 border-none rounded-xl text-sm font-bold p-3 mt-1" placeholder="5.0">
                         </div>
                         <div>
                            <label for="custom-amount" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase">容量 (ml)</label>
                            <input type="number" id="custom-amount" class="w-full bg-base-50 dark:bg-base-800 border-none rounded-xl text-sm font-bold p-3 mt-1" placeholder="350">
                         </div>
                    </div>
                </div>
                <div class="pt-4 border-t border-base-100 dark:border-base-800 space-y-3">
                    <input type="text" id="beer-brewery" list="brewery-list" placeholder="ブルワリー名（任意）" class="w-full bg-base-50 dark:bg-base-800 border-none rounded-xl text-xs font-bold p-3">
                    <div class="flex gap-2">
                        <input type="text" id="beer-brand" list="brand-list" placeholder="銘柄名（任意）" class="flex-1 bg-base-50 dark:bg-base-800 border-none rounded-xl text-xs font-bold p-3">
                        <button id="btn-search-untappd" class="bg-yellow-400 text-yellow-900 px-3 rounded-xl shadow-sm hover:bg-yellow-500 transition">
                            <i class="ph-bold ph-magnifying-glass" aria-hidden="true"></i>
                        </button>
                    </div>
                    <div class="bg-base-50 dark:bg-base-800 p-3 rounded-xl border border-base-200 dark:border-base-700 space-y-2">
                        <div class="flex items-center justify-between">
                            <span class="flex items-center gap-1.5 text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                <i class="ph-duotone ph-star text-sm text-amber-500" aria-hidden="true"></i>
                                評価
                            </span>
                            <div class="relative">
                                <select id="beer-rating" class="appearance-none pl-2 pr-8 py-1 bg-white dark:bg-base-900 border border-base-200 dark:border-base-700 rounded text-sm font-bold text-amber-600 dark:text-amber-400 outline-none cursor-pointer focus:ring-2 focus:ring-indigo-400">
                                    <option value="0">評価なし</option>
                                    <option value="1">★☆☆☆☆</option>
                                    <option value="2">★★☆☆☆</option>
                                    <option value="3">★★★☆☆</option>
                                    <option value="4">★★★★☆</option>
                                    <option value="5">★★★★★</option>
                                </select>
                                <div class="absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none text-amber-600 dark:text-amber-400 text-xs">▼</div>
                            </div>
                        </div>
                        <textarea id="beer-memo" rows="2" placeholder="テイスティングメモ..." class="w-full p-2.5 bg-white dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-lg focus:ring-2 focus:ring-indigo-400 outline-none text-xs resize-none dark:text-white placeholder-gray-400"></textarea>
                    </div>
                    <!-- 味わい記録セクション (折りたたみ) -->
                    <div id="flavor-section" class="border border-base-200 dark:border-base-700 rounded-xl overflow-hidden">
                        <button type="button" id="flavor-toggle" class="w-full flex items-center justify-between p-3 bg-base-50 dark:bg-base-800 hover:bg-base-100 dark:hover:bg-base-700 transition">
                            <span class="flex items-center gap-1.5 text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                <i class="ph-duotone ph-chart-polar text-sm text-orange-500" aria-hidden="true"></i>
                                味わいを記録する
                            </span>
                            <i class="ph-bold ph-caret-down text-sm transition-transform duration-200" id="flavor-toggle-icon" aria-hidden="true"></i>
                        </button>
                        <div id="flavor-inputs" class="hidden p-3 space-y-3 bg-base-50 dark:bg-base-800">
                            <div class="flavor-axis" data-axis="bitterness">
                                <div class="flex items-center justify-between mb-1.5">
                                    <span class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">苦味</span>
                                    <span class="text-[11px] text-gray-500 dark:text-gray-400">0=なし ← → 5=強い</span>
                                </div>
                                <div class="flex gap-1.5" id="flavor-bitterness">
                                    <button type="button" data-val="0" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">0</button>
                                    <button type="button" data-val="1" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">1</button>
                                    <button type="button" data-val="2" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">2</button>
                                    <button type="button" data-val="3" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">3</button>
                                    <button type="button" data-val="4" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">4</button>
                                    <button type="button" data-val="5" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">5</button>
                                </div>
                            </div>
                            <div class="flavor-axis" data-axis="sweetness">
                                <div class="flex items-center justify-between mb-1.5">
                                    <span class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">甘味</span>
                                    <span class="text-[11px] text-gray-500 dark:text-gray-400">0=ドライ → 5=甘い</span>
                                </div>
                                <div class="flex gap-1.5" id="flavor-sweetness">
                                    <button type="button" data-val="0" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">0</button>
                                    <button type="button" data-val="1" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">1</button>
                                    <button type="button" data-val="2" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">2</button>
                                    <button type="button" data-val="3" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">3</button>
                                    <button type="button" data-val="4" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">4</button>
                                    <button type="button" data-val="5" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">5</button>
                                </div>
                            </div>
                            <div class="flavor-axis" data-axis="fruity">
                                <div class="flex items-center justify-between mb-1.5">
                                    <span class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">フルーティー</span>
                                    <span class="text-[11px] text-gray-500 dark:text-gray-400">0=なし ← → 5=強い</span>
                                </div>
                                <div class="flex gap-1.5" id="flavor-fruity">
                                    <button type="button" data-val="0" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">0</button>
                                    <button type="button" data-val="1" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">1</button>
                                    <button type="button" data-val="2" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">2</button>
                                    <button type="button" data-val="3" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">3</button>
                                    <button type="button" data-val="4" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">4</button>
                                    <button type="button" data-val="5" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">5</button>
                                </div>
                            </div>
                            <div class="flavor-axis" data-axis="body">
                                <div class="flex items-center justify-between mb-1.5">
                                    <span class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ボディ</span>
                                    <span class="text-[11px] text-gray-500 dark:text-gray-400">0=ライト ← → 5=フル</span>
                                </div>
                                <div class="flex gap-1.5" id="flavor-body">
                                    <button type="button" data-val="0" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">0</button>
                                    <button type="button" data-val="1" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">1</button>
                                    <button type="button" data-val="2" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">2</button>
                                    <button type="button" data-val="3" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">3</button>
                                    <button type="button" data-val="4" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">4</button>
                                    <button type="button" data-val="5" class="flavor-btn flex-1 py-2 text-xs font-bold rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition">5</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <label class="flex items-center justify-between p-3 bg-base-50 dark:bg-base-800 rounded-xl cursor-pointer border border-base-200 dark:border-base-700 hover:border-indigo-300 dark:hover:border-indigo-700 transition">
                        <span class="flex items-center gap-1.5 text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            <i class="ph-duotone ph-arrow-square-out text-sm text-amber-500" aria-hidden="true"></i>
                            保存後にUntappdを開く
                        </span>
                        <div class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="untappd-check" class="sr-only peer">
                            
                            <div class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-yellow-500"></div>
                        </div>
                    </label>
                    <div id="beer-kcal-preview-container" class="mt-4 p-4 bg-base-50 dark:bg-base-800 rounded-xl border border-base-200 dark:border-base-700">
                        <div class="flex items-center justify-between">
                            <span class="flex items-center gap-1.5 text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                <i class="ph-duotone ph-calculator text-sm text-indigo-500" aria-hidden="true"></i>
                                推定カロリー借金
                            </span>
                            <div id="beer-kcal-preview" class="text-2xl font-black text-brand dark:text-brand-light">
                                0 <span class="text-xs font-bold ml-1 text-gray-500 dark:text-gray-400">kcal</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ★修正: Footer統一 (Cancel / Next / Save) -->
            <div class="relative z-10 p-4 border-base-100 dark:border-base-800 flex gap-2 bg-white/95 dark:bg-base-900/95 backdrop-blur-md">
                <button id="btn-delete-beer" aria-label="この記録を削除" class="hidden w-12 flex-shrink-0 items-center justify-center rounded-xl bg-red-50 text-red-500 dark:bg-red-900/20 hover:bg-red-100 transition">
                    <i class="ph-bold ph-trash text-lg" aria-hidden="true"></i>
                </button>

                <button data-action="modal:close" data-args='["beer-modal"]' class="flex-1 py-3 text-xs font-bold text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition active:scale-95">
                    キャンセル
                </button>

                <button id="btn-save-beer-next" class="flex-1 py-3 text-xs font-bold text-brand bg-indigo-50 dark:bg-indigo-900/30 rounded-xl hover:bg-indigo-100 dark:hover:bg-indigo-900/50 transition active:scale-95 leading-tight">
                    <span class="inline-block text-center">記録して<wbr>次へ</span>
                </button>

                <button id="btn-save-beer" class="flex-[2] py-3 text-sm font-bold bg-brand text-white rounded-xl shadow-lg shadow-brand/30 hover:bg-brand-dark transition active:scale-95">
                    記録する
                </button>
            </div>
        </div>
    </div>

    <!-- Check Modal (Updated: UI Consistency) -->
    <div id="check-modal" role="dialog" aria-modal="true" aria-labelledby="check-modal-title" class="fixed inset-0 hidden items-center justify-center bg-black/50 backdrop-blur-sm p-4">
        <div class="bg-white dark:bg-base-900 w-full max-w-md rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] transform transition-all scale-95 opacity-0 duration-200">
        <div class="relative z-10 p-4 border-b border-base-100 dark:border-base-800 flex justify-between items-center bg-white/95 dark:bg-base-900/95 backdrop-blur-md">
                <h3 id="check-modal-title" class="font-bold text-lg">デイリーチェック</h3>
                <button data-action="modal:close" data-args='["check-modal"]' aria-label="閉じる" class="w-11 h-11 rounded-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center transition text-gray-500 dark:text-gray-400">
    <i class="ph-bold ph-x text-lg" aria-hidden="true"></i>
                </button>
            </div>

            <!-- Scrollable Body -->
            <div class="p-5 overflow-y-auto space-y-4 relative z-0">
                <div>
                    <label for="manual-date" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase">日付</label>
                    <input type="date" id="check-date" class="w-full bg-base-50 dark:bg-base-800 border-none rounded-xl text-sm font-bold p-3 mt-1">
                </div>

                <div id="drinking-section" class="p-4 bg-orange-50 dark:bg-orange-900/20 rounded-xl border border-orange-100 dark:border-orange-800/50 transition-all">
                    <label class="flex items-center justify-between cursor-pointer">
                        <span class="font-bold text-orange-800 dark:text-orange-300">
            休肝日
        </span>
                        <div class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="check-is-dry" class="sr-only peer" data-action-change="check:toggleDryDay">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"></div>
                        </div>
                    </label>
                    <p class="text-[11px] text-orange-600/70 mt-2">一滴も飲まなかった日はスイッチON</p>
                </div>
                
                <div id="check-items-container" class="grid grid-cols-2 gap-3">
                    <!-- JS Injected -->
                </div>

                <div>
                    <label for="check-weight" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase">体重 (kg)</label>
                    <input type="number" id="check-weight" step="0.1" class="w-full bg-base-50 dark:bg-base-800 border-none rounded-xl text-sm font-bold p-3 mt-1" placeholder="任意">
                </div>
            </div>

            <!-- Footer (Border Added, Consistent Layout) -->
            <div class="relative z-10 p-4 border-base-100 dark:border-base-800 flex gap-2 bg-white/95 dark:bg-base-900/95 backdrop-blur-md">
                <button data-action="modal:close" data-args='["check-modal"]' class="flex-1 py-3 font-bold text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition">
                    キャンセル
                </button>
                <button id="btn-save-check" class="flex-[2] py-3 rounded-xl bg-emerald-500 text-white font-bold shadow-lg shadow-emerald-500/30 hover:bg-emerald-600 transition active:scale-95">
                    記録する
                </button>
            </div>
        </div>
    </div>

    <div id="timer-modal" role="dialog" aria-modal="true" class="fixed inset-0 hidden items-center justify-center bg-base-900 text-white transition-opacity duration-300">
        <div id="timer-bubbles-container" class="absolute inset-0 overflow-hidden pointer-events-none opacity-40 z-0"></div>
        
        <div class="relative z-10 w-full max-w-md h-full flex flex-col justify-center p-8 text-center">
            
            <button data-action="modal:closeTimer" aria-label="タイマーを閉じる" class="absolute top-6 right-6 w-11 h-11 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center hover:bg-black/30 transition z-50 cursor-pointer text-white border border-white/10">
    <i class="ph-bold ph-x text-lg" aria-hidden="true"></i></button>

            <div class="absolute top-8 left-0 right-0 flex justify-center">
                <div class="flex items-center gap-2 bg-black/20 backdrop-blur-sm px-3 py-1 rounded-full border border-white/5">
                    <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span>
                    <span class="text-xs font-bold tracking-widest uppercase opacity-90 text-white shadow-sm">Live Recording</span>
                </div>
            </div>

            <div class="flex flex-col items-center justify-center py-6 relative">
                <div class="relative w-80 h-80 flex items-center justify-center">
                    
                    <div class="absolute inset-0 rounded-full border-[8px] border-white/10"></div>

                    <div id="timer-ring" class="absolute inset-0 rounded-full transition-all duration-300" 
                         style="-webkit-mask-image: radial-gradient(transparent 67%, black 69%); mask-image: radial-gradient(transparent 67%, black 69%);">
                    </div>

                    <div class="z-10 flex flex-col items-center">
                        <div id="timer-display" class="text-7xl font-black font-mono tracking-tighter mb-4 tabular-nums relative z-10 text-white drop-shadow-md font-numeric">00:00</div>
                        
                        <div class="flex items-center gap-5 text-sm font-bold opacity-100 relative z-10 bg-black/30 px-5 py-2 rounded-full backdrop-blur-md border border-white/10 shadow-lg">
                            <span class="flex items-center gap-1.5">
                                <i class="ph-fill ph-fire text-white text-base" aria-hidden="true"></i> 
                                <span id="timer-kcal" class="tabular-nums text-white font-numeric">0.0</span>
                                <span class="text-[11px] text-white/70">kcal</span>
                            </span>
                            <span class="w-px h-3 bg-white/30"></span>
                            <span class="flex items-center gap-1.5">
                                <i class="ph-fill ph-beer-bottle text-white text-base" aria-hidden="true"></i> 
                                <span id="timer-beer" class="tabular-nums text-white text-lg font-numeric">0</span>
                                <span class="text-[11px] text-white/70">ml</span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="space-y-8 mt-4">
                <div class="relative w-full max-w-xs mx-auto">
                    <div class="bg-black/20 backdrop-blur-md rounded-2xl flex items-center w-full overflow-hidden border border-white/10 hover:bg-black/30 transition relative shadow-lg">
                        <select id="timer-exercise-select" class="w-full bg-transparent text-white font-bold text-center appearance-none p-4 outline-none cursor-pointer relative z-20 text-shadow-sm">
                        </select>
                        <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none text-white/70 z-10">
                            <i class="ph-bold ph-caret-down" aria-hidden="true"></i>
                        </div>
                    </div>
                </div>

                <div class="flex justify-center gap-8 items-center h-24">
                    <button id="btn-timer-reset" data-action="timer:reset" class="hidden w-20 h-20 rounded-full bg-black/20 backdrop-blur-md text-white hover:bg-black/40 flex items-center justify-center shadow-xl shadow-black/20 transition-all active:scale-95 border-4 border-white/30 cursor-pointer z-10">
                        <i class="ph-bold ph-arrow-counter-clockwise text-3xl" aria-hidden="true"></i>
                    </button>

                    <button id="btn-timer-toggle" data-action="timer:toggle" class="w-20 h-20 rounded-full bg-white text-black hover:bg-gray-200 flex items-center justify-center shadow-xl shadow-black/20 transition-all active:scale-95 border-4 border-white/50 cursor-pointer z-10">
                        <i id="icon-timer-toggle" class="ph-fill ph-play text-3xl ml-1" aria-hidden="true"></i>
                    </button>
                    
                    <button id="btn-timer-finish" data-action="timer:finish" class="hidden w-20 h-20 rounded-full bg-black/20 backdrop-blur-md text-white hover:bg-black/40 flex items-center justify-center shadow-xl shadow-black/20 transition-all active:scale-95 border-4 border-white/30 cursor-pointer z-10">
                        <i class="ph-bold ph-check text-3xl" aria-hidden="true"></i>
                    </button>
                </div>
                
                <p class="text-[11px] text-white/50 mt-4 font-bold drop-shadow-sm">ブラウザを完全に閉じないでください</p>
            </div>
        </div>
    </div>

    <div id="rollover-modal" role="dialog" aria-modal="true" aria-labelledby="rollover-title" class="fixed inset-0 hidden flex items-center justify-center p-4 transition-opacity duration-300">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm"></div>
    
    <div class="bg-white dark:bg-base-900 w-full max-w-sm rounded-3xl p-6 relative z-10 shadow-2xl border border-gray-100 dark:border-gray-800 transform transition-all scale-100 animate-bounce-in">
        
        <div class="text-center mb-6">
            <div id="rollover-icon-container" class="w-16 h-16 bg-indigo-100 dark:bg-indigo-900/50 text-brand dark:text-brand-light rounded-full flex items-center justify-center mx-auto mb-4 text-3xl shadow-lg shadow-indigo-500/20">
                <i id="rollover-icon" class="ph-fill ph-flag-checkered" aria-hidden="true"></i>
            </div>
            
            <h3 class="text-xl font-black text-base-900 dark:text-white mb-2" id="rollover-title">
                期間が終了しました！
            </h3>
            
            <p class="text-sm text-gray-500 dark:text-gray-400 leading-relaxed" id="rollover-desc">
                期間が終了しました。
            </p>
        </div>

        <div id="rollover-actions" class="space-y-3"></div>
        
    </div>
</div>

        <!-- Exercise Modal -->
    <div id="exercise-modal" role="dialog" aria-modal="true" aria-labelledby="exercise-modal-title" class="fixed inset-0 hidden items-center justify-center bg-black/50 backdrop-blur-sm p-4">
    <div class="bg-white dark:bg-base-900 w-full max-w-md rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] transform transition-all scale-95 opacity-0 duration-200">
        
        <div class="relative z-10 p-4 border-b border-base-100 bg-white/95 dark:border-base-800 flex justify-between items-center bg-base-50 dark:bg-base-900">
            <h3 id="exercise-modal-title" class="font-bold text-lg">運動を追加</h3>
            <button data-action="modal:close" data-args='["exercise-modal"]' aria-label="閉じる" class="w-11 h-11 rounded-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center transition text-gray-500 dark:text-gray-400">
    <i class="ph-bold ph-x text-lg" aria-hidden="true"></i></button>
        </div>
        
        <div class="p-5 space-y-4 overflow-y-auto relative z-0">
            <input type="hidden" id="editing-exercise-id">
            <div class="grid grid-cols-5 gap-3">
                <div class="col-span-3">
                    <label for="beer-date" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase ml-1">日付</label>
                    <input type="date" id="manual-date" class="w-full bg-base-50 dark:bg-base-900 border-0 rounded-xl px-3 py-3 text-sm font-bold">
                </div>
                <div class="col-span-2">
                    <label for="manual-minutes" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase ml-1">分</label>
                    <input type="number" id="manual-minutes" placeholder="30" class="w-full bg-base-50 dark:bg-base-900 border-0 rounded-xl px-3 py-3 text-sm font-bold">
                </div>
            </div>
            <div>
                <label for="exercise-select" class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase ml-1">種目</label>
                <select id="exercise-select" class="w-full bg-base-50 dark:bg-base-900 border-0 rounded-xl px-3 py-3 text-sm font-bold"></select>
            </div>

            <label class="flex items-center justify-between p-3 bg-orange-50 dark:bg-orange-900/20 rounded-xl cursor-pointer border border-orange-100 dark:border-orange-800/50 transition">
                <div class="flex items-center gap-2">
                    <i class="ph-duotone ph-fire text-2xl text-orange-500" aria-hidden="true"></i>
                    <div class="flex flex-col">
                        <span class="text-xs font-bold text-orange-800 dark:text-orange-200">Apply Streak Bonus</span>
                        <span class="text-[11px] text-orange-600/70 dark:text-orange-400/70">継続ボーナスを適用する</span>
                    </div>
                </div>
                <div class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="manual-apply-bonus" class="sr-only peer" checked>
                    <div class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-orange-500"></div>
                </div>
            </label>
        </div>

        <div class="relative z-10 p-4 border-base-100 bg-white/95 dark:border-base-800 flex gap-2 bg-base-50 dark:bg-base-900">
            <button id="btn-delete-exercise" aria-label="この記録を削除" class="hidden w-12 flex-shrink-0 items-center justify-center rounded-xl bg-red-50 text-red-500 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/40 transition">
                <i class="ph-bold ph-trash text-xl" aria-hidden="true"></i>
            </button>

            <button data-action="modal:close" data-args='["exercise-modal"]' class="flex-1 py-3 font-bold text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition">
                キャンセル
            </button>

            <button id="btn-save-exercise" class="flex-[2] py-3 bg-brand text-white rounded-xl font-bold shadow-lg hover:bg-brand-dark transition">
                記録する
            </button>
        </div>
    </div>
</div>

<div id="day-detail-modal" aria-labelledby="day-detail-date" 
     class="fixed inset-0 z-50 flex items-end sm:items-center justify-center hidden pointer-events-none" 
     role="dialog" aria-modal="true">

    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity duration-300 opacity-0" data-action="modal:close" data-args='["day-detail-modal"]'>
    </div>

    <div class="relative w-full sm:max-w-md h-[85vh] sm:h-[80vh] bg-white dark:bg-base-900 rounded-t-3xl sm:rounded-3xl shadow-2xl flex flex-col overflow-hidden transform transition-all duration-300 translate-y-full sm:translate-y-10 scale-95 opacity-0 pointer-events-auto">

        <div class="absolute top-3 left-1/2 -translate-x-1/2 w-12 h-1.5 bg-gray-300 dark:bg-gray-600 rounded-full sm:hidden z-20"></div>

        <div class="relative z-10 p-5 pt-8 sm:pt-5 border-b border-gray-200 dark:border-base-800 bg-white/90 dark:bg-base-900/90 backdrop-blur-md shrink-0">
            
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 id="day-detail-date" class="text-3xl font-black text-gray-900 dark:text-white font-['Outfit'] leading-none tracking-tight">
                        </h3>
                    <p class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-widest mt-1.5">デイリーサマリー</p>
                </div>
                <button data-action="modal:close" data-args='["day-detail-modal"]' aria-label="閉じる"
                        class="w-11 h-11 rounded-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center transition text-gray-500 dark:text-gray-400 active:scale-90">
                    <i class="ph-bold ph-x text-lg" aria-hidden="true"></i>
                </button>
            </div>

            <div class="grid grid-cols-3 gap-3 text-center">
                <div class="p-3 bg-emerald-50 dark:bg-emerald-900/20 rounded-2xl border border-emerald-100 dark:border-emerald-800/50">
                    <div class="text-[11px] font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-wider mb-0.5">PAYBACK</div>
                    <div id="day-detail-earned" class="text-lg font-black text-emerald-600 dark:text-emerald-400 font-['Outfit']">0</div>
                </div>
                <div class="p-3 bg-red-50 dark:bg-red-900/20 rounded-2xl border border-red-100 dark:border-red-800/50">
                    <div class="text-[11px] font-bold text-red-600 dark:text-red-400 uppercase tracking-wider mb-0.5">DEBT</div>
                    <div id="day-detail-consumed" class="text-lg font-black text-red-600 dark:text-red-400 font-['Outfit']">0</div>
                </div>
                <div class="p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl border border-indigo-100 dark:border-indigo-800/50">
                    <div class="text-[11px] font-bold text-brand dark:text-brand-light uppercase tracking-wider mb-0.5">BALANCE</div>
                    <div id="day-detail-balance" class="text-lg font-black text-brand dark:text-brand-light font-['Outfit']">0</div>
                </div>
            </div>
        </div>

        <div id="day-detail-list" class="flex-1 overflow-y-auto p-4 space-y-3 relative z-0 overscroll-contain">
            </div>

        <div class="relative z-10 p-4 border-t border-gray-100 dark:border-base-800 bg-white/90 dark:bg-base-900/90 backdrop-blur-md shrink-0 pb-8 sm:pb-4">
            <div class="flex gap-3">
                <button id="btn-day-add-log" 
                        class="flex-1 py-3.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-xl font-bold text-xs flex items-center justify-center gap-2 hover:bg-gray-200 dark:hover:bg-gray-700 transition active:scale-95">
                    <i class="ph-bold ph-plus text-lg" aria-hidden="true"></i> ログを追加
                </button>
                <button id="btn-day-check"
                        class="flex-[2] py-3.5 bg-brand text-white rounded-xl font-bold text-xs flex items-center justify-center gap-2 hover:bg-brand-dark shadow-lg shadow-brand/30 transition active:scale-95">
                    <i class="ph-bold ph-check-square text-lg" aria-hidden="true"></i> デイリーチェック
                </button>
            </div>
        </div>

    </div>
</div>

<div id="day-add-selector" class="fixed inset-0 flex items-end sm:items-center justify-center hidden pointer-events-none" role="dialog" aria-modal="true" aria-labelledby="day-add-selector-label">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity duration-300 opacity-0 pointer-events-auto" data-action="modal:toggle" data-args='["day-add-selector"]'></div>
    <div class="relative w-full sm:max-w-md bg-white dark:bg-base-900 rounded-t-[2rem] sm:rounded-[2rem] p-6 pb-10 transform transition-all duration-300 translate-y-full sm:translate-y-10 scale-95 opacity-0 pointer-events-auto shadow-2xl overflow-hidden">    
        <div class="absolute top-3 left-1/2 -translate-x-1/2 w-12 h-1.5 bg-gray-300 dark:bg-gray-600 rounded-full sm:hidden"></div>
        <div class="flex justify-between items-center mb-6 mt-2 sm:mt-0">
            <div>
                <span class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ログを追加</span>
                <h3 id="day-add-selector-label" class="text-xl font-black text-base-900 dark:text-white leading-none mt-0.5 font-['Outfit']">
                    種類を選択
                </h3>
            </div>
            <button data-action="modal:toggle" data-args='["day-add-selector"]' aria-label="閉じる" class="w-11 h-11 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                <i class="ph-bold ph-x text-lg" aria-hidden="true"></i>
            </button>
        </div>

        <div class="grid grid-cols-2 gap-3">
            <button data-action="dayAdd:openBeer" class="p-5 bg-amber-50 dark:bg-amber-900/20 rounded-2xl border border-amber-100 dark:border-amber-800/50 flex flex-col items-center gap-3 hover:bg-amber-100 dark:hover:bg-amber-900/40 transition active:scale-95 group shadow-sm">
                <div class="w-14 h-14 rounded-full bg-white dark:bg-amber-900/40 flex items-center justify-center shadow-sm group-hover:scale-110 transition duration-300">
                    <i class="ph-duotone ph-beer-bottle text-3xl text-amber-500" aria-hidden="true"></i>
                </div>
                <div class="text-center">
                    <span class="block text-base font-black text-gray-900 dark:text-white font-['Outfit'] tracking-tight">Beer</span>
                    <span class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Add Record</span>
                </div>
            </button>

            <button data-action="dayAdd:openExercise" class="p-5 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl border border-indigo-100 dark:border-indigo-800/50 flex flex-col items-center gap-3 hover:bg-indigo-100 dark:hover:bg-indigo-900/40 transition active:scale-95 group shadow-sm">
                <div class="w-14 h-14 rounded-full bg-white dark:bg-indigo-900/40 flex items-center justify-center shadow-sm group-hover:scale-110 transition duration-300">
                    <i class="ph-duotone ph-sneaker-move text-3xl text-indigo-500" aria-hidden="true"></i>
                </div>
                <div class="text-center">
                    <span class="block text-base font-black text-gray-900 dark:text-white font-['Outfit'] tracking-tight">Exercise</span>
                    <span class="text-[11px] font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">Add Activity</span>
                </div>
            </button>

            <button data-action="dayAdd:openCheck" class="col-span-2 p-4 bg-gray-50 dark:bg-base-800 rounded-2xl border border-gray-100 dark:border-base-700 flex items-center justify-center gap-3 hover:bg-gray-100 dark:hover:bg-base-700 transition active:scale-95 group">
                <div class="w-8 h-8 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center">
                    <i class="ph-bold ph-check-square text-lg text-emerald-600 dark:text-emerald-400" aria-hidden="true"></i>
                </div>
                <span class="text-sm font-bold text-gray-700 dark:text-gray-300">Daily Check (体調・体重)</span>
            </button>
        </div>
        
    </div>
</div>

    
<div id="help-modal" role="dialog" aria-modal="true" aria-labelledby="help-modal-title" class="fixed inset-0 bg-gray-900/60 hidden flex items-center justify-center p-4 backdrop-blur-sm transition-opacity duration-300">
    <div class="bg-white dark:bg-base-900 w-full max-w-lg max-h-[85vh] rounded-3xl shadow-2xl flex flex-col overflow-hidden animate-slide-up">
        
        <div class="flex justify-between items-center p-5 border-b border-gray-100 dark:border-gray-800 bg-gray-50/50 dark:bg-gray-800/50 backdrop-blur">
            <h3 id="help-modal-title" class="text-lg font-black text-base-900 dark:text-white flex items-center gap-2">
                <i class="ph-duotone ph-book-open text-indigo-500" aria-hidden="true"></i>
                ユーザーガイド
            </h3>
            <button data-action="modal:close" data-args='["help-modal"]' aria-label="閉じる" class="w-11 h-11 rounded-full bg-gray-200/50 dark:bg-gray-700/50 flex items-center justify-center hover:bg-gray-300 dark:hover:bg-gray-600 transition text-gray-500 dark:text-gray-300">
                <i class="ph-bold ph-x text-lg" aria-hidden="true"></i>
            </button>
        </div>
        
        <div class="p-6 overflow-y-auto custom-scrollbar space-y-10">
    
            <section class="text-center space-y-4">
                <img src="logo-header.png" 
                     alt="NOMUTORE Logo" 
                     class="w-24 h-24 mx-auto object-contain mb-3 animate-neon-flicker drop-shadow-md dark:drop-shadow-[0_0_15px_rgba(99,102,241,0.6)]">
                <h4 class="text-xl font-black text-base-900 dark:text-white leading-tight">
                    飲んだら、動いて返す。<br>
                    <span class="text-brand dark:text-brand-light">「実質ゼロ」</span>を目指そう。
                </h4>
                <p class="text-sm text-gray-500 dark:text-gray-400 leading-relaxed">
                    NOMUTOREは、飲酒カロリーを<strong class="text-red-500">「借金」</strong>、運動カロリーを<strong class="text-emerald-500">「返済」</strong>と捉え、<br>
                    好きなビールを<br>罪悪感なく楽しみ続けるための<br>新感覚ヘルスケアアプリです。
                </p>
            </section>

            <hr class="border-gray-100 dark:border-gray-800">

            <section>
                <h4 class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="ph-duotone ph-flag-checkered" aria-hidden="true"></i> はじめかた
                </h4>
                <div class="space-y-3">
                    <div class="flex items-start gap-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-2xl">
                        <div class="w-8 h-8 rounded-full bg-brand text-white flex items-center justify-center font-bold text-sm shrink-0">1</div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">プロフィールを設定する</h5>
                            <p class="text-xs text-gray-500 mt-1">
                                体重や身長を入力することで、基礎代謝を計算し、あなたに最適な運動カロリーを算出します。
                            </p>
                        </div>
                    </div>
                    <div class="flex items-start gap-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-2xl">
                        <div class="w-8 h-8 rounded-full bg-brand text-white flex items-center justify-center font-bold text-sm shrink-0">2</div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">好きなビールを選ぶ</h5>
                            <p class="text-xs text-gray-500 mt-1">
                                よく飲むスタイル（IPAやラガーなど）を設定しておくと、ホーム画面の残高表示が「ビール何本分」に自動換算されます。
                            </p>
                        </div>
                    </div>
                    <div class="flex items-start gap-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-2xl">
                        <div class="w-8 h-8 rounded-full bg-brand text-white flex items-center justify-center font-bold text-sm shrink-0">3</div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">飲んだら記録！</h5>
                            <p class="text-xs text-gray-500 mt-1">
                                飲酒したら即記録。借金（カロリー）が溜まったら、通勤や家事などの「運動」で返済しましょう。
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <section>
                <h4 id="help-dashboard" class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="ph-duotone ph-house" aria-hidden="true"></i> ホーム (Home)
                </h4>
                <div class="space-y-3">
                    
                    <div class="p-4 rounded-2xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700">
                        <h5 class="font-bold text-sm mb-2 flex items-center gap-2">
                            <i class="ph-fill ph-sphere text-indigo-500 text-lg" aria-hidden="true"></i> センターオーブ
                        </h5>
                        <p class="text-xs text-gray-600 dark:text-gray-300 mb-2">
                            オーブを<strong>タップ</strong>すると、表示モードが切り替わります。
                        </p>
                        <div class="grid grid-cols-3 gap-2 text-[11px] text-gray-500 dark:text-gray-400">
                            <div class="bg-white dark:bg-base-900 p-2 rounded border border-gray-100 dark:border-gray-700">
                                <span class="font-bold block text-base-900 dark:text-white mb-0.5">ビール本数</span>
                                お気に入りの350mlを基準に換算した本数と運動時間。
                            </div>
                            <div class="bg-white dark:bg-base-900 p-2 rounded border border-gray-100 dark:border-gray-700">
                                <span class="font-bold block text-base-900 dark:text-white mb-0.5">kcal 表示</span>
                                カロリー収支と解消に必要な運動時間。
                            </div>
                            <div class="bg-white dark:bg-base-900 p-2 rounded border border-gray-100 dark:border-gray-700">
                                <span class="font-bold block text-base-900 dark:text-white mb-0.5">アルコール量</span>
                                期間内の純アルコール摂取量(g)を表示。
                            </div>
                        </div>
                        <ul class="text-xs space-y-3 text-gray-600 dark:text-gray-300 mt-4">
                            <li class="flex gap-3">
                                <span class="text-red-500 font-black text-lg">●</span>
                                <div>
                                    <strong class="block text-base-900 dark:text-white">借金モード</strong>
                                    <span class="text-[11px] opacity-80">収支マイナス時。「完済まであと何分の運動が必要か」を表示。</span>
                                </div>
                            </li>
                            <li class="flex gap-3">
                                <span class="text-emerald-500 font-black text-lg">●</span>
                                <div>
                                    <strong class="block text-base-900 dark:text-white">貯金モード</strong>
                                    <span class="text-[11px] opacity-80">収支プラス時。オーブが黄金に輝き、心置きなく飲める状態。</span>
                                </div>
                            </li>
                        </ul>
                        <div class="flex flex-col gap-1.5 mt-3 pt-3 border-t border-gray-200 dark:border-gray-700 text-[11px] text-gray-500 dark:text-gray-400">
                            <div class="flex items-center gap-2">
                                <i class="ph-fill ph-share-network text-pink-400"></i>
                                <span><strong>左ボタン</strong>: 現在のランク・収支画像をSNSでシェア</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="ph-fill ph-question text-indigo-400"></i>
                                <span><strong>右ボタン</strong>: このユーザーガイドを開く</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <div class="p-3 rounded-2xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700">
                            <div class="flex items-center gap-2 mb-2">
                                <div class="shrink-0 w-8 h-8 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center">
                                    <i class="ph-fill ph-trophy text-brand dark:text-brand-light text-lg" aria-hidden="true"></i>
                                </div>
                                <div class="flex flex-col leading-none">
                                    <span class="text-[11px] font-bold text-base-900 dark:text-white">ユーザー<br>ランク</span>
                                    <span class="text-[11px] font-black text-indigo-500 uppercase tracking-tighter mt-0.5">LIVER RANK</span>
                                </div>
                            </div>
                            <p class="text-[11px] text-gray-500 dark:text-gray-400 leading-tight">
                                あなたのレベルを示す称号。継続日数と成果で変動します。
                            </p>
                        </div>

                        <div class="p-3 rounded-2xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700">
                            <div class="flex items-center gap-2 mb-2">
                                <div class="shrink-0 w-8 h-8 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center">
                                    <i class="ph-fill ph-calendar-check text-emerald-600 dark:text-emerald-400 text-lg" aria-hidden="true"></i>
                                </div>
                                <div class="flex flex-col leading-none">
                                    <span class="text-[11px] font-bold text-base-900 dark:text-white">デイリー<br>チェック</span>
                                    <span class="text-[11px] font-black text-emerald-500 uppercase tracking-tighter mt-0.5">DAILY CHECK</span>
                                </div>
                            </div>
                            <p class="text-[11px] text-gray-500 dark:text-gray-400 leading-tight">
                                日々の体重や休肝日、自分好みの体調項目をチェック。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 rounded-2xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700">
                        <div class="flex items-center gap-3">
                            <div class="shrink-0 w-8 h-8 rounded-full bg-rose-100 dark:bg-rose-900/30 flex items-center justify-center">
                                <i class="ph-fill ph-wine text-rose-600 dark:text-rose-400 text-lg" aria-hidden="true"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center gap-2">
                                    <span class="text-[11px] font-bold text-base-900 dark:text-white">週間アルコール</span>
                                    <span class="text-[11px] font-black text-rose-500 uppercase tracking-tighter">WEEKLY ALCOHOL</span>
                                </div>
                                <p class="text-[11px] text-gray-500 dark:text-gray-400 leading-tight mt-1">
                                    今週の純アルコール摂取量とガイドライン上限をバーで表示。
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="p-4 rounded-2xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700">
                        <h5 class="font-bold text-sm mb-2 flex items-center gap-2">
                            <i class="ph-fill ph-fire text-orange-500 text-lg" aria-hidden="true"></i> ストリーク & 週間カレンダー
                        </h5>
                        <div class="text-xs text-gray-600 dark:text-gray-300 space-y-2">
                            <p>「休肝日」か「完済日」を連続で達成すると<strong>ストリーク</strong>が積み上がり、継続ボーナス倍率（x1.1〜x1.3）が上昇します。</p>
                            <p>直近1週間の<strong>週間カレンダー</strong>では、各日の飲酒・運動・チェック結果をアイコンで確認できます。日付を<strong>タップ</strong>すると詳細画面が開き、過去ログの確認・修正・追加登録が可能です。</p>
                        </div>
                    </div>

                    <div class="bg-indigo-50 dark:bg-indigo-900/30 p-3 rounded-xl text-[11px] text-brand dark:text-indigo-300 font-bold flex items-center justify-center gap-2 mt-2">
                        <i class="ph-bold ph-info text-lg" aria-hidden="true"></i>
                        <span>ランク基準やアイコン（評価）の詳細は<br>下部の「ゲームの仕組み」を参照</span>
                    </div>

                </div>
            </section>

            <section>
                <h4 id="help-record" class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="ph-duotone ph-plus-circle" aria-hidden="true"></i> 記録 (Record)
                </h4>
                <div class="space-y-3">
                    <div class="p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl border border-indigo-100 dark:border-indigo-800/40">
                        <h5 class="font-bold text-sm text-base-900 dark:text-white mb-1">クイック登録</h5>
                        <p class="text-xs text-gray-500 dark:text-gray-400 leading-relaxed">
                            上段の<strong>「よく飲むビール」</strong>と<strong>「いつもの運動」</strong>は、記録履歴から自動で表示されるショートカットです。よく使う記録をワンタップで追加できます。
                        </p>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-beer-bottle text-amber-600 dark:text-amber-500" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">ビールを記録（手入力）</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                「ビールを記録」では、プリセット選択・カスタム入力・Untappd検索に対応。銘柄名やスタイル、ABV、容量を設定して記録できます。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-note-pencil text-gray-600 dark:text-gray-400" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">運動を記録（手入力）</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                ジムだけでなく、<span class="text-brand dark:text-brand-light font-bold">通勤・家事・散歩</span>などの日常活動も入力可能。時間や運動種別から消費カロリーを記録できます。
                            </p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                            <div class="w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-xl shrink-0">
                                <i class="ph-duotone ph-check-circle text-emerald-600 dark:text-emerald-400" aria-hidden="true"></i>
                            </div>
                            <div>
                                <h5 class="font-bold text-sm text-base-900 dark:text-white">デイリーチェック</h5>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                    休肝日・体重に加え、睡眠や体調などの項目をチェック。設定タブで項目を追加・編集できます。
                                </p>
                            </div>
                        </div>

                        <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                            <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-xl shrink-0">
                                <i class="ph-duotone ph-timer text-brand dark:text-brand-light" aria-hidden="true"></i>
                            </div>
                            <div>
                                <h5 class="font-bold text-sm text-base-900 dark:text-white">ストップウォッチ</h5>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                    運動時間をリアルタイム計測し、記録に変換。バックグラウンド計測にも対応しています。
                                </p>
                            </div>
                        </div>
                    </div>

                </div>
            </section>

            <section>
                <h4 id="help-stats"            <section>
                <h4 id="help-stats" class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="ph-duotone ph-chart-line" aria-hidden="true"></i> 統計 (Stats)
                </h4>
                <div class="space-y-3">
                    <div class="p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl border border-indigo-100 dark:border-indigo-800/40">
                        <h5 class="font-bold text-sm text-base-900 dark:text-white mb-1">2つのビューを切り替え</h5>
                        <p class="text-xs text-gray-500 dark:text-gray-400 leading-relaxed">
                            Statsでは<strong>Activity / Beer</strong>を上部タブで切り替えます。Activityで活動推移を、Beerで銘柄・スタイル傾向を確認できます。
                        </p>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-fill ph-calendar-dots section-icon text-indigo-500" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">活動カレンダー（Activity）</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                月単位の<strong>ヒートマップ</strong>で長期的な活動パターンを可視化。◀▶ボタンで月をさかのぼれます。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-fill ph-scales section-icon text-emerald-500" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">カロリーバランス推移（Activity）</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                日々のカロリー収支と体重変化をグラフで確認。1W・1M・3Mでレンジを切り替えられます。
                            </p>
                            <div class="flex flex-col gap-1 mt-2">
                                <div class="flex items-center gap-2 text-[11px] text-gray-500 dark:text-gray-400">
                                    <span class="w-2.5 h-2.5 rounded-full bg-emerald-500 shrink-0"></span>
                                    <span><strong>緑:</strong> 運動（貯金）</span>
                                </div>
                                <div class="flex items-center gap-2 text-[11px] text-gray-500 dark:text-gray-400">
                                    <span class="w-2.5 h-2.5 rounded-full bg-red-500 shrink-0"></span>
                                    <span><strong>赤:</strong> 飲酒（借金）</span>
                                </div>
                                <div class="flex items-center gap-2 text-[11px] text-gray-500 dark:text-gray-400">
                                    <span class="w-2.5 h-0.5 bg-indigo-500 shrink-0"></span>
                                    <span><strong>紫:</strong> 体重推移</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-rose-100 dark:bg-rose-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-fill ph-heartbeat text-rose-500" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">ヘルスインサイト（Activity）</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                <strong>飲酒日 vs 休肝日</strong>の状態/行動達成率を比較。右上フィルターで<strong>1W・1M・3M</strong>の表示期間を切り替えて推移を確認できます。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-beer-bottle text-amber-600 dark:text-amber-500" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">ビール統計（Beer）</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                期間内の総飲酒量・銘柄数・スタイル傾向をドーナツチャートで確認。「今期」「30日」「90日」「全期間」でレンジを切り替えられます。
                            </p>
                        </div>
                    </div>

                </div>
            </section>

            <section>
                <h4 id="help-cellar" class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="ph-duotone ph-books" aria-hidden="true"></i> セラー (Cellar)
                </h4>
                <div class="space-y-3">
                    <div class="p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl border border-indigo-100 dark:border-indigo-800/40">
                        <h5 class="font-bold text-sm text-base-900 dark:text-white mb-1">3つのビューを切り替え</h5>
                        <p class="text-xs text-gray-500 dark:text-gray-400 leading-relaxed">
                            Cellarでは<strong>Logs / Collections / Archives</strong>をタブで切り替えて、記録の確認・整理・振り返りを行います。
                        </p>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-list-dashes text-brand dark:text-brand-light" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">履歴管理 (Logs)</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                時系列でログを表示。種別・期間・キーワードで検索でき、編集モードでは複数選択して一括削除も可能です。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-books text-brand dark:text-brand-light" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">コレクション (Collections)</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                銘柄・ブルワリー単位で集計し、ランキングやフィルターで傾向を把握。スタイルや評価などで絞り込みできます。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-archive text-brand dark:text-brand-light" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">過去の記録 (Archives)</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                期間リセットごとの結果を保存。各期間の収支・達成状況をあとから確認できます。
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <section>
                <h4 id="help-settings" class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="ph-duotone ph-gear" aria-hidden="true"></i> 設定 (Settings)
                </h4>

                <div class="space-y-3">
                    <div class="flex items-center gap-3 px-3 py-2 bg-indigo-50 dark:bg-indigo-900/20 rounded-xl text-[11px] text-indigo-700 dark:text-indigo-300 font-bold border border-indigo-100 dark:border-indigo-800/40">
                        <i class="ph-fill ph-gear text-lg shrink-0"></i>
                        <span>画面上部ヘッダー右側の <strong>⚙ アイコン</strong> から開けます</span>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-user-circle text-orange-600 dark:text-orange-500" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">プロフィール</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                体重・身長・年齢・計算基準を設定し、基礎代謝や各種目安の計算に反映します。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-sliders text-brand dark:text-brand-light" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">環境設定</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                集計期間（週次・月次・カスタム・永久）やテーマ、メイン/サブビール、基準運動、デフォルト運動を設定できます。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-bell-ringing text-amber-600 dark:text-amber-500" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">通知</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                未記録時のデイリーリマインダーと、期間リセット前日サマリーのON/OFFと時刻を設定できます。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-check-square-offset text-emerald-600 dark:text-emerald-400" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">デイリーチェック項目編集</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                ライブラリからの追加とカスタム作成で、毎日記録する状態/行動項目を調整できます。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-blue-50 dark:bg-blue-900/20 rounded-2xl border border-blue-100 dark:border-blue-900/50 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-xl shrink-0">
                            <i class="ph-duotone ph-database text-blue-600 dark:text-blue-500" aria-hidden="true"></i>
                        </div>
                        <div class="flex-1">
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">データ管理とバックアップ</h5>
                            <p class="text-xs text-blue-900/70 dark:text-blue-200/70 mt-1 leading-relaxed">
                                Googleドライブ連携、CSVエクスポート、JSONバックアップ/復元に対応。大切な記録を守るため、定期バックアップがおすすめです。
                            </p>
                            <div class="mt-2">
                                <button data-action="help:goToSettings" class="text-[11px] font-bold bg-white dark:bg-blue-800 text-blue-600 dark:text-blue-200 px-3 py-1.5 rounded-lg border border-blue-200 dark:border-blue-700 hover:bg-blue-50 transition shadow-sm">
                                    設定画面へ移動してバックアップ
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
            </section>

            <section>
                <h4 id="help-useful" class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="ph-duotone ph-sparkle" aria-hidden="true"></i> 便利な機能
                </h4>
                
                <div class="space-y-3">
                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-white dark:bg-gray-700 flex items-center justify-center shadow-sm shrink-0">
                            <i class="ph-duotone ph-lightning text-yellow-500 text-xl" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">クイック登録</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                あなたの履歴を解析し、記録タブには<strong>「よく飲むビール」</strong>と<strong>「いつもの運動」</strong>、「＋」ボタンには<strong>「前回のビール・運動」</strong>を自動表示。ワンタップで記録できます。
                            </p>
                        </div>
                    </div>
                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-white dark:bg-gray-700 flex items-center justify-center shadow-sm shrink-0">
                            <i class="ph-duotone ph-share-network text-pink-500 text-xl" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">SNSシェア用画像生成</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                ホーム画面からは「現在のランクと借金」、ビール記録後は「写真に銘柄・カロリーを合成」した画像を生成してシェアできます。
                            </p>
                        </div>
                    </div>

                    <div class="p-3 bg-gray-50 dark:bg-gray-800/50 rounded-2xl border border-gray-100 dark:border-gray-700 flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-white dark:bg-gray-700 flex items-center justify-center shadow-sm shrink-0">
                            <i class="ph-bold ph-calculator text-gray-500 dark:text-gray-400 text-xl" aria-hidden="true"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-sm text-base-900 dark:text-white">NetMETS計算</h5>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 leading-relaxed">
                                運動強度(METs)から安静時(1.0)を引き、<strong>「運動で増えた消費分」</strong>のみを厳密に計算しています。
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <section>
                <h4 id="game-mechanics" class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="ph-duotone ph-lightning" aria-hidden="true"></i> ゲームの仕組み
                </h4>
                <div class="bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-2xl border border-indigo-100 dark:border-indigo-900/50 space-y-6">
                    
                    <div class="space-y-3">
                        <h5 class="font-black text-brand dark:text-brand-light text-sm flex items-center gap-1">
                            <i class="ph-duotone ph-trophy text-purple-500" aria-hidden="true"></i> ユーザーランク
                        </h5>
                        <p class="text-xs text-indigo-800/80 dark:text-indigo-300/80 mb-2">
                            ホーム画面左下に表示される称号です。開始からの日数でモードが切り替わります。
                        </p>
                        
                        <div class="bg-white/60 dark:bg-black/20 p-3 rounded-lg border border-indigo-100 dark:border-indigo-800/30">
                            <span class="text-xs font-bold text-orange-500 uppercase tracking-wider flex items-center gap-1 mb-1">
                                <i class="ph-duotone ph-egg" aria-hidden="true"></i> ルーキー期間（1〜14日目）
                            </span>
                            <p class="text-xs text-indigo-800/80 dark:text-indigo-300/80 leading-relaxed mb-2">
                                最初の2週間は「成功率」で判定されます。<br>
                                成功率 = (休肝日 + 完済日) ÷ 経過日数
                            </p>
                            <ul class="text-[11px] space-y-1 text-gray-600 dark:text-gray-400 pl-3 border-l-2 border-orange-200 dark:border-orange-800">
                                <li class="flex items-center gap-1"><i class="ph-fill ph-star text-orange-500" aria-hidden="true"></i> <strong>新星 (Rookie S):</strong> 成功率 70%以上</li>
                                <li class="flex items-center gap-1"><i class="ph-fill ph-fire text-orange-500" aria-hidden="true"></i> <strong>期待の星 (Rookie A):</strong> 成功率 40%以上</li>
                                <li class="flex items-center gap-1"><i class="ph-fill ph-bird text-orange-500" aria-hidden="true"></i> <strong>駆け出し (Rookie B):</strong> 成功率 25%以上</li>
                                <li class="flex items-center gap-1"><i class="ph-fill ph-egg text-gray-500 dark:text-gray-400" aria-hidden="true"></i> <strong>たまご (Beginner):</strong> まだこれから！</li>
                            </ul>
                        </div>

                        <div class="bg-white/60 dark:bg-black/20 p-3 rounded-lg border border-indigo-100 dark:border-indigo-800/30">
                            <span class="text-xs font-bold text-indigo-500 uppercase tracking-wider flex items-center gap-1 mb-1">
                                <i class="ph-duotone ph-shield-check" aria-hidden="true"></i> 通常期間（15日目〜）
                            </span>
                            <p class="text-xs text-indigo-800/80 dark:text-indigo-300/80 leading-relaxed mb-2">
                                15日目からは「継続日数（ストリーク）」の実力勝負。<br>
                                1日でもサボるとランクが下がります。維持しましょう！
                            </p>
                            <div class="grid grid-cols-2 gap-2 text-[11px] text-gray-600 dark:text-gray-400">
                                <div class="p-2 bg-white/50 dark:bg-black/20 rounded border border-purple-100 dark:border-purple-900/30">
                                    <span class="block font-bold text-purple-600 dark:text-purple-400 flex items-center gap-1"><i class="ph-fill ph-crown" aria-hidden="true"></i> 神の肝臓</span>
                                    継続 20日以上
                                </div>
                                <div class="p-2 bg-white/50 dark:bg-black/20 rounded border border-indigo-100 dark:border-indigo-900/30">
                                    <span class="block font-bold text-brand dark:text-brand-light flex items-center gap-1"><i class="ph-fill ph-shield" aria-hidden="true"></i> 鉄の肝臓</span>
                                    継続 12日以上
                                </div>
                                <div class="p-2 bg-white/50 dark:bg-black/20 rounded border border-emerald-100 dark:border-emerald-900/30">
                                    <span class="block font-bold text-emerald-600 dark:text-emerald-400 flex items-center gap-1"><i class="ph-fill ph-leaf" aria-hidden="true"></i> 健康志向</span>
                                    継続 8日以上
                                </div>
                                <div class="p-2 bg-white/50 dark:bg-black/20 rounded border border-red-100 dark:border-red-900/30">
                                    <span class="block font-bold text-red-500 flex items-center gap-1"><i class="ph-fill ph-warning section-icon" aria-hidden="true"></i> 要注意</span>
                                    継続 7日以下
                                </div>
                            </div>
                        </div>
                    </div>

                    <hr class="border-indigo-200 dark:border-indigo-800/50">

                    <div class="space-y-2">
                        <h5 class="font-black text-brand dark:text-brand-light text-sm flex items-center gap-1">
                            <i class="ph-duotone ph-fire text-orange-500" aria-hidden="true"></i> 継続ボーナス
                        </h5>
                        <p class="text-xs text-indigo-800/80 dark:text-indigo-300/80 leading-relaxed">
                            「休肝」か「完済」を継続すると、運動時の消費カロリーにボーナスがつきます。
                            <br><span class="font-bold mt-1 block opacity-80">・3日: 1.1x / 7日: 1.2x / 14日: 1.3x</span>
                        </p>
                    </div>

                    <hr class="border-indigo-200 dark:border-indigo-800/50">

                    <div class="space-y-2">
                        <h5 class="font-black text-brand dark:text-brand-light text-sm flex items-center gap-1">
                            <i class="ph-duotone ph-calendar-star text-yellow-500" aria-hidden="true"></i> 日次評価
                        </h5>
                        <p class="text-xs text-indigo-800/80 dark:text-indigo-300/80 mb-2">
                            その日の行動によって、カレンダーに刻まれるアイコンが変わります。S評価（金メダル）を目指しましょう！
                        </p>
                        
                        <div class="grid grid-cols-2 gap-2 text-[11px]">
                            <div class="flex items-center gap-2 p-2 rounded bg-white/60 dark:bg-black/20">
                                <i class="ph-fill ph-medal text-xl text-yellow-500" aria-hidden="true"></i>
                                <div>
                                    <span class="font-bold text-yellow-600 dark:text-yellow-400">評価 S</span>
                                    <div class="text-[11px] opacity-70">休肝日 + 運動</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded bg-white/60 dark:bg-black/20">
                                <i class="ph-duotone ph-medal text-xl text-cyan-500" aria-hidden="true"></i>
                                <div>
                                    <span class="font-bold text-cyan-600 dark:text-cyan-400">評価 A</span>
                                    <div class="text-[11px] opacity-70">運動のみ</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded bg-white/60 dark:bg-black/20">
                                <i class="ph-fill ph-coffee text-xl text-emerald-500" aria-hidden="true"></i>
                                <div>
                                    <span class="font-bold text-emerald-600 dark:text-emerald-400">評価 B</span>
                                    <div class="text-[11px] opacity-70">休肝日のみ</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded bg-white/60 dark:bg-black/20">
                                <i class="ph-fill ph-fire text-xl text-blue-500" aria-hidden="true"></i>
                                <div>
                                    <span class="font-bold text-blue-600 dark:text-blue-400">評価 C</span>
                                    <div class="text-[11px] opacity-70">飲酒 + 完済</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded bg-white/60 dark:bg-black/20">
                                <i class="ph-fill ph-person-simple-run text-xl text-blue-400" aria-hidden="true"></i>
                                <div>
                                    <span class="font-bold text-blue-500 dark:text-blue-300">評価 D</span>
                                    <div class="text-[11px] opacity-70">借金残り</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded bg-white/60 dark:bg-black/20">
                                <i class="ph-fill ph-beer-stein text-xl text-red-500" aria-hidden="true"></i>
                                <div>
                                    <span class="font-bold text-red-500">評価 E</span>
                                    <div class="text-[11px] opacity-70">飲酒のみ</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-2 pt-2 border-t border-indigo-200 dark:border-indigo-800/50">
                        <h5 class="font-black text-brand dark:text-brand-light text-sm flex items-center gap-1">
                            <i class="ph-duotone ph-arrows-clockwise" aria-hidden="true"></i> 期間リセット
                        </h5>
                        <p class="text-xs text-indigo-800/80 dark:text-indigo-300/80 leading-relaxed">
                            指定した期間で借金がリセットされます。「週次」は<strong>「毎週月曜日」</strong>、「月次」は<strong>「毎月1日」</strong>に借金がリセットされてゼロになります。期間単位で帳尻を合わせればOKです。<br>
                        「カスタム」を選ぶと、旅行や短期集中ダイエット用に「プロジェクト名・開始日・終了日」を自由に設定して計測できます。
                        </p>
                    </div>
                </div>
            </section>

            <section>
                <h4 class="text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="ph-duotone ph-scales" aria-hidden="true"></i> ビール以外の換算ガイド
                </h4>
                <div class="overflow-hidden rounded-xl border border-gray-200 dark:border-gray-700">
                    <table class="w-full text-left border-collapse text-[11px]">
                        <tbody class="divide-y divide-gray-100 dark:divide-gray-700 bg-white dark:bg-gray-900 text-gray-700 dark:text-gray-200">
                            <tr><td class="p-3 flex items-center gap-2"><i class="ph-fill ph-brandy text-amber-600" aria-hidden="true"></i> ハイボール (7%)</td><td class="p-3 font-bold text-brand dark:text-brand-light">アンバーエール</td></tr>
                            <tr><td class="p-3 flex items-center gap-2"><i class="ph-fill ph-orange-slice text-yellow-500" aria-hidden="true"></i> レモンサワー</td><td class="p-3 font-bold text-brand dark:text-brand-light">ペールエール</td></tr>
                            <tr><td class="p-3 flex items-center gap-2"><i class="ph-fill ph-skull text-blue-500" aria-hidden="true"></i> ストロング系 (9%)</td><td class="p-3 font-bold text-brand dark:text-brand-light">IPA (West Coast)</td></tr>
                            <tr><td class="p-3 flex items-center gap-2"><i class="ph-fill ph-wine text-red-500" aria-hidden="true"></i> ワイン / 日本酒</td><td class="p-3 font-bold text-brand dark:text-brand-light">トリペル (250ml)</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <div class="mt-8 p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl text-center">
                <p class="text-[11px] text-indigo-800 dark:text-indigo-300 mb-2 font-bold">
                    バグ報告やご要望はこちら
                </p>
                <a href="https://forms.gle/NUiN5R2rfxPvEixj8" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 text-xs font-bold text-brand dark:text-brand-light border-b border-indigo-200 dark:border-indigo-700 pb-0.5 hover:opacity-70 transition">
                    フィードバックを送る <i class="ph-bold ph-arrow-square-out" aria-hidden="true"></i>
                </a>
            </div>

            <div class="text-center pt-4">
                <p class="text-[11px] text-gray-300 dark:text-gray-600 tracking-widest">NOMUTORE Beta - NO BEER NO LIFE</p>
            </div>

        </div>
        
        <div class="p-4 border-t border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-gray-800">
            <button data-action="modal:close" data-args='["help-modal"]' class="w-full bg-base-900 dark:bg-white dark:text-base-900 text-white font-bold py-3.5 rounded-xl shadow-lg transition transform active:scale-95 text-sm">
                閉じる
            </button>
        </div>
    </div>
</div>


<div id="concept-page" class="fixed inset-0 z-[550] hidden flex items-center justify-center bg-[#0f172a] text-white px-8 transition-all duration-700 opacity-0 hidden">
    <div class="max-w-md w-full space-y-12 text-center">
        <div class="flex justify-center items-center gap-8">
            <div class="concept-icon-float">
                <i class="ph-fill ph-beer-bottle text-6xl text-amber-500" aria-hidden="true"></i>
            </div>
            <span class="text-3xl font-black text-slate-600">×</span>
            <div class="concept-icon-float-delay">
                <i class="ph-fill ph-sneaker-move text-6xl text-indigo-400" aria-hidden="true"></i>
            </div>
        </div>

        <div class="space-y-6">
            <h2 class="text-2xl font-black tracking-tighter italic leading-tight">
                DRINK. BURN. CONDITION.<br>
                <span class="text-amber-500">罪悪感</span>を、<span class="text-indigo-400">エネルギー</span>へ。
            </h2>
            <p class="text-xs font-bold text-slate-400 leading-loose">
                NOMUTOREは、ビールのカロリーを<br>運動で<span class="text-white">「完済」</span>することを目的とした、<br>新感覚ヘルスケアアプリです。<br><br>
                飲んだ分だけ、動く。動いた分だけ、旨くなる。<br>
                このシンプルな循環が、<br>あなたの身体と心を整えます。
            </p>
        </div>

        <button data-action="onboarding:goToWizard" class="w-full py-5 bg-brand text-white rounded-2xl font-black tracking-[0.2em] shadow-xl shadow-indigo-900/40 hover:bg-indigo-500 transition-all active:scale-95">
            START CONDITIONING
        </button>
    </div>
</div>

<div id="onboarding-modal" class="fixed inset-0 hidden flex items-center justify-center bg-base-50/90 dark:bg-base-900/90 backdrop-blur-xl transition-all duration-300 opacity-0 scale-95">
        <div class="w-full max-w-md p-6 relative">
            
            <div class="flex justify-center mb-6">
                <img src="logo-header.png" class="w-16 h-16 object-contain animate-neon-flicker">
            </div>

            <div class="bg-white dark:bg-base-900 rounded-3xl shadow-2xl overflow-hidden border border-white/20 dark:border-white/5">
                <div class="px-8 pt-8 pb-4 text-center">
                    <h2 id="wizard-title" class="text-2xl font-black text-base-900 dark:text-white mb-2"></h2>
                    <p id="wizard-desc" class="text-xs font-bold text-gray-500 dark:text-gray-400 leading-relaxed"></p>
                </div>

                <div id="wizard-content" class="px-8 py-4 min-h-[200px] flex flex-col justify-center">
                    </div>

                <div class="px-8 pb-8 pt-4 flex flex-col gap-6">
                    <div id="wizard-dots" class="flex justify-center gap-2"></div>
                    
                    <div class="flex justify-between items-center">
                        <button id="btn-wizard-prev" data-action="onboarding:prevStep" class="text-gray-500 dark:text-gray-400 font-bold text-sm hover:text-gray-600 dark:hover:text-gray-200 px-4 py-2">
                            Back
                        </button>
                        <button id="btn-wizard-next" data-action="onboarding:nextStep">
                            Next
                        </button>
                    </div>
                </div>
            </div>
            
            <p class="text-[11px] text-center text-gray-500 dark:text-gray-400 mt-6 font-bold tracking-widest opacity-50">INITIAL SETUP</p>
        </div>
    </div>

    <script type="module" src="main.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js')
                .then(reg => console.log('SW registered'))
                .catch(err => console.log('SW load fail', err));
        }
    </script>
</body>

</html>


























